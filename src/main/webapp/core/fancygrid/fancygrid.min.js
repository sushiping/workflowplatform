var Fancy={global:this,cls:"fancy",version:"1.0.0",site:"fancygrid.com"};Fancy.apply=function(a,b){for(var c in b)a[c]=b[c]},Fancy.applyIf=function(a,b){for(var c in b)void 0===a[c]&&(a[c]=b[c])},Fancy.namespace=function(){for(var a=0,b=arguments.length;b>a;a++){var c=arguments[a],d=c.split("."),e=1,f=d.length;Fancy.global[d[0]]=Fancy.global[d[0]]||{};for(var g=Fancy.global[d[0]];f>e;e++)g[d[e]]=g[d[e]]||{},g=g[d[e]]}},Fancy.ns=Fancy.namespace,Fancy.typeOf=function(a){if(null===a)return"null";var b=typeof a;if("undefined"===b||"string"===b||"number"===b||"boolean"===b)return b;var c=Object.prototype.toString,d=c.call(a);if(void 0!==a.length)return"array";switch(d){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}return"function"===b?"function":"object"===b?"object":void 0},Fancy.isArray="isArray"in Array?Array.isArray:function(a){var b=Object.prototype.toString;return"[object Array]"===b.call(a)},Fancy.isObject=function(a){var b=Object.prototype.toString;return"[object Object]"===b.call(a)},Fancy.isFunction=function(a){var b=Object.prototype.toString;return"[object Function]"===b.apply(a)},Fancy.isString=function(a){return"string"==typeof a},Fancy.isNumber=function(a){return"number"==typeof a&&isFinite(a)},Fancy.isBoolean=function(a){return"boolean"==typeof a},Fancy.each=function(a,b){var c=Fancy.typeOf(a);switch(c){case"array":for(var d=0,e=a.length;e>d;d++)b(a[d],d,a);break;case"object":for(var f in a)b(a[f],f,a)}},Fancy.mixin=function(a,b){var c=0,d=b.length;if("object"===Fancy.typeOf(b[0]))for(;d>c;c++)for(var e=b[c],f=e._class,g=e.methods,h=0,i=g.length;i>h;h++){var j=g[h];a[j]=f.prototype[j]}else for(;d>c;c++){var e=b[c];if(Fancy.isString(e)){var k=Fancy.ClassManager.getMixin(e);k?Fancy.apply(a,k.prototype):Fancy.ClassManager.waitMixin(e,a)}else Fancy.apply(a,e.prototype)}},Fancy.Mixin=function(a,b){var c=a.split("."),d=1,e=c.length-1;Fancy.ns(a);for(var f=Fancy.global[c[0]];e>d;d++)f=f[c[d]];c.length>1?(f[c[c.length-1]]=function(){},f[c[c.length-1]].prototype=b):(Fancy.global[c[0]]=function(){},Fancy.global[c[0]].prototype=b);var g=Fancy.ClassManager.waitMixins[a];if(g){g=g.waiters;for(var d=0,e=g.length;e>d;d++)Fancy.apply(g[d],b)}},Fancy.applyConfig=function(a,b){var c,b=b||{};if(a._isConfigApplied===!0)return a;for(c in b)a[c]=b[c];return a._isConfigApplied=!0,a},Fancy.styleToString=function(a){var b="";a=a||{};for(var c in a)b+=c+": "+a[c]+";";return b},Fancy.apply(Fancy,{prefix:"fancy-gen-",idSeed:0,zIndex:1,id:function(a,b){return a?(a=a.dom||{},a.id||(a.id=(b||Fancy.prefix)+ ++Fancy.idSeed),a.id):(b||Fancy.prefix)+ ++Fancy.idSeed}}),function(){var a=navigator.userAgent.toLowerCase(),b=function(b){return b.test(a)},c=b(/opera/),d=!c&&b(/msie/);Fancy.apply(Fancy,{isOpera:c,isIE:d}),Fancy.getViewSize=function(){var a=[];return Fancy.isIE?(a[0]=document.documentElement.clientHeight,a[1]=document.documentElement.clientWidth):(a[0]=window.innerHeight,a[1]=window.innerWidth),a},Fancy.getScroll=function(){var a=document.documentElement,b=document.body;return a&&(a.scrollTop||a.scrollLeft)?[a.scrollTop,a.scrollLeft]:b?[b.scrollTop,b.scrollLeft]:[0,0]},Fancy.getMouseWheelEventName=function(){return"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll"},Fancy.isTouch=void 0!==document.ontouchstart}(),Fancy.themes={},Fancy.defineTheme=function(a,b){var c={};b.extend&&Fancy.apply(c,Fancy.getTheme(b.extend).config),Fancy.apply(c,b.config),b.config=c,Fancy.themes[a]=b},Fancy.getTheme=function(a){return Fancy.themes[a]},Fancy.defineTheme("default",{config:{cellHeaderHeight:30,cellWidth:70,minCellWidth:40,cellHeight:32,titleHeight:42,barHeight:38,bottomScrollHeight:12,minCenterWidth:100,panelBorderWidth:2,groupRowHeight:31}}),Fancy.defineTheme("blue",{extend:"default",config:{cellHeaderHeight:30,cellWidth:70,minCellWidth:40,cellHeight:32,titleHeight:42,barHeight:38,bottomScrollHeight:12,minCenterWidth:100,panelBorderWidth:1}}),Fancy.String={format:function(a){var b,c,d;if("array"===Fancy.typeOf(arguments[1]))b=arguments[1];else for(d=arguments.length,b=[],c=1;d>c;c++)b[c-1]=arguments[c];return a.replace(/\[(\d+)]/g,function(a,c){return b[c]})},upFirstChar:function(a){return a[0].toLocaleUpperCase()+a.substr(1,a.length)},trim:function(a){return a.replace(/\s/g,"")}},Fancy.Array={copy:function(a){return a.slice()}},Fancy.Object={copy:function(a){var b={};for(var c in a)b[c]=a[c];return b}},Fancy.Collection=function(a){var b=this;if(b.items=[],b.keys=[],b.map={},b.indexMap={},b.length=0,a)if(a.length>0)for(var c=0,d=a.length;d>c;c++)b.add(c,a[c]);else for(var e in a)b.add(e,a[e])},Fancy.Collection.prototype={add:function(a,b){var c=this;c.items.push(b),c.keys.push(a),c.map[a]=b,c.indexMap[a]=c.length,c.length++},remove:function(a){var b=this,c=b.indexMap[a];b.items.splice(c,1),b.keys.splice(c,1),delete b.indexMap[c],delete b.map[a],b.length--},removeAll:function(){var a=this;a.items=[],a.keys=[],a.indexMap={},a.map={},a.length=0},get:function(a){var b=this;return b.map[a]},each:function(a){for(var b=this,c=0,d=b.length;d>c;c++)a(b.keys[c],b.items[c],c,b.length)}},Fancy.Template=function(a){var b=this;Fancy.isArray(a)?b.tpl=a.join(""):b.tpl=a,b.compile()},Fancy.Template.prototype={re:/\{([\w\-]+)\}/g,getHTML:function(a){var b=this;return b.compiled(a)},compile:function(){function fn(a,b){return b="values['"+b+"']","'+("+b+" === undefined ? '' : "+b+")+'"}var me=this,sep="+";return eval("me.compiled = function(values){ return '"+me.tpl.replace(me.re,fn)+"';};"),me}},Fancy.key={BACKSPACE:8,TAB:9,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_PLUS:107,NUM_MINUS:109,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90},Fancy.Key={isNum:function(a){var b=Fancy.key;switch(a){case b.ZERO:case b.ONE:case b.TWO:case b.THREE:case b.FOUR:case b.FIVE:case b.SIX:case b.SEVEN:case b.EIGHT:case b.NINE:case b.NUM_ZERO:case b.NUM_ONE:case b.NUM_TWO:case b.NUM_THREE:case b.NUM_FOUR:case b.NUM_FIVE:case b.NUM_SIX:case b.NUM_SEVEN:case b.NUM_EIGHT:case b.NUM_NINE:return!0;default:return!1}},isNumControl:function(a,b){var c=Fancy.key;if(Fancy.Key.isNum(a))return!0;if(b.shiftKey&&187===a)return!0;switch(a){case c.NUM_PLUS:case 189:case c.NUM_MINUS:case c.BACKSPACE:case c.DELETE:case c.TAB:case c.ENTER:case c.RETURN:case c.SHIFT:case c.CTRL:case c.ALT:case c.ESC:case c.END:case c.HOME:case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:case c.INSERT:return!0;default:return!1}}},function(){var a={},b={},c=function(a,b){for(var c in b.prototype)void 0===a.prototype[c]&&(a.prototype[c]=b.prototype[c])},d=function(){this.waitMixins={}};d.prototype={items:new Fancy.Collection,add:function(a,b){var c=a.split("."),d=1,e=c.length-1;Fancy.ns(a);for(var f=Fancy.global[c[0]];e>d;d++)f=f[c[d]];c.length>1?f[c[c.length-1]]=b:Fancy.global[c[0]]=b,this.items.add(a,b)},get:function(a){return this.items.get(a)},waitMixin:function(a,b){var c=this;c.waitMixins[a]=c.waitMixins[a]||{waiters:[]},c.waitMixins[a].waiters.push(b)},getMixin:function(a){var b=a.split("."),c=1,d=b.length,e=Fancy.global[b[0]];if(void 0===e)return!1;for(;d>c;c++)if(e=e[b[c]],void 0===e)return!1;return e}},Fancy.ClassManager=new d,Fancy.define=function(d,e){var e=e||{},f=[];if(Fancy.isArray(d)&&(f=d,d=f[0]),e.constructor===Object&&(void 0===e.extend?e.constructor=function(){}:e.constructor=function(){this.Super("constructor",arguments)}),void 0===e.extend)a[d]=e.constructor;else{a[d]=e.constructor;var g;switch(typeof e.extend){case"string":g=Fancy.ClassManager.get(e.extend),a[d].prototype.$Super=Fancy.ClassManager.get(e.extend);break;case"function":g=e.extend,a[d].prototype.$Super=e.extend}delete e.extend,a[d].prototype.Super=function(a,b){var c=this;switch(c.$Iam?c.$Iam=Fancy.ClassManager.get(c.$Iam.prototype.$Super.prototype.$name):c.$Iam=Fancy.ClassManager.get(c.$Super.prototype.$name),a){case"const":case"constructor":c.$Iam.apply(c,b);break;default:c.$Iam.prototype[a].apply(c,b)}delete c.$Iam},c(a[d],g)}a[d].prototype.$name=d,e.mixins&&(Fancy.mixin(a[d].prototype,e.mixins),delete a[d].prototype.mixins),void 0!==e.plugins&&(void 0===a[d].prototype.$plugins&&(a[d].prototype.$plugins=[]),a[d].prototype.$plugins=a[d].prototype.$plugins.concat(e.plugins),delete a[d].prototype.plugins);for(var h in e)a[d].prototype[h]=e[h];var i=a[d];e.singleton===!0&&(delete a[d],i=new i(e),a[d]=i),f.length>1?Fancy.each(f,function(a){Fancy.ClassManager.add(a,i)}):Fancy.ClassManager.add(d,i),e.type?(b[e.type]=i,Fancy.addWidgetType(e.type,i)):e.ptype&&(b[e.type]=i,Fancy.addPluginByType(e.ptype,i))},Fancy.getClassByType=function(a){return b[a]}}(),Fancy.MixinClass=function(){},Fancy.MixinClass.prototype={initId:function(){var a=this,b=a.prefix||Fancy.prefix;a.id=a.id||Fancy.id(null,b),Fancy.addWidget(a.id,a)},initPlugins:function(){var a,b,c,d=this,e=d;if(d.plugins=d.plugins||[],d._plugins&&(d.plugins=d.plugins.concat(d._plugins)),void 0!==d.plugins&&(d.$plugins=d.plugins,delete d.plugins),void 0!==d.$plugins)for(var f,g=0,h=d.$plugins,i=h.length,j={};i>g;g++){c=h[g],c.widget=e;var k=c.type||c.ptype;if(j[k]!==!0){if(j[k]=!0,a=Fancy.getPluginByType(k),void 0===a)throw new Error("[FancyGrid Error] - some of module was not loaded. Grid plugin does not exist - "+k);b=new a(c),f=c.inWidgetName||b.inWidgetName,void 0!==f&&(e[f]=b)}}}},Fancy.define("Fancy.Data",{constructor:function(a){var b=this;if(b.map={},a)for(var c=0,d=a.length,e=b.map;d>c;c++)e[c]=a[c];b.length=0},add:function(a,b){var c=this;c.map[a]=b,c.length++},get:function(a){return this.map[a]}}),Fancy.define("Fancy.Model",{constructor:function(a){var b=this,c={},d=b.fields||[],e=0,f=d.length;if(Fancy.isArray(a)){for(;f>e;e++){var g=d[e];c[g]=a[e]}b.data=c}else{if(void 0===b.fields){d=[];for(var g in a)d.push(g);b.fields=d}for(f=d.length;f>e;e++){var g=d[e];void 0===a[g]?c[g]="":c[g]=a[g]}b.data=c}},get:function(a){var b=this;return b.data[a]},set:function(a,b){var c=this;c.data[a]=b}}),Fancy.define("Fancy.PluginManager",{singleton:!0,constructor:function(){var a=this;a.ptypes=new Fancy.Data},addPlugin:function(a,b){this.ptypes.add(a,b)},getPlugin:function(a){return this.ptypes.get(a)}}),Fancy.addPluginByType=function(a,b){Fancy.PluginManager.addPlugin(a,b)},Fancy.getPluginByType=function(a){return Fancy.PluginManager.getPlugin(a)},Fancy.define("Fancy.WidgetManager",{singleton:!0,constructor:function(){var a=this;a.wtypes=new Fancy.Data,a.widgets=new Fancy.Data},addWidgetType:function(a,b){b.prototype.wtype=a,this.wtypes.add(a,b)},getWidgetClassByType:function(a){return this.wtypes.get(a)},addWidget:function(a,b){this.widgets.add(a,b)},getWidget:function(a){return this.widgets.get(a)}}),Fancy.addWidgetType=function(a,b){Fancy.WidgetManager.addWidgetType(a,b)},Fancy.getWidgetClassByType=function(a){return Fancy.WidgetManager.getWidgetClassByType(a)},Fancy.addWidget=function(a,b){Fancy.WidgetManager.addWidget(a,b)},Fancy.getWidget=function(a){return Fancy.WidgetManager.getWidget(a)},function(){var a=0,b={};Fancy.define(["Fancy.Event","Fancy.Observable"],{mixins:[Fancy.MixinClass],constructor:function(a){var b=this,a=a||{};if(Fancy.applyConfig(b,a),b.$events={},b.listeners||b.events)for(var c=b.listeners||b.events,d=0,e=c.length;e>d;d++){var f=c[d],g=null,h=null,i=null,j=[];for(var k in f)"scope"===k?i=f[k]:"params"===k?j=f[k]:(g=k,h=f[k]);if(null===g||Fancy.isFunction(h)===!1)throw new Error("Event was not set");if(Fancy.isArray(j)===!1)throw new Error("params must be array");b.addEvent(g),b.on(g,h,i,j)}},on:function(c,d,e,f){if(void 0===this.$events[c])throw new Error("Event name is not set: "+c);d.$fancyFnSeed=a,b[a]=d,a++,this.$events[c].push({fn:d,scope:e,params:f||[]})},un:function(a,b){var c=this,d=c.$events[a];if(!d)return!1;for(var e=0,f=d.length;f>e;e++){var g=d[e];if(g.fn.$fancyFnSeed===b.$fancyFnSeed)return g.toRemove=!0,!0}return!1},once:function(a,b,c){var d=this,e=function(){b.apply(this,arguments),d.un(a,e)};d.on(a,e,c)},unAll:function(){this.$events={}},unAllByType:function(a){this.$events[a]=[]},fire:function(a){var b=this,c=b.$events[a];if(!c)return!1;for(var d=1,e=arguments.length,f=[b];e>d;d++)f.push(arguments[d]);for(var d=0,e=c.length;e>d;d++){var g=c[d],h=[];g.toRemove!==!0?(h=h.concat(f),g.params&&(h=h.concat(g.params)),g.fn.apply(g.scope||b,h)):(c.splice(d,1),d--,e=c.length)}},addEvent:function(a){return this.addEvents(a)},addEvents:function(a){var b=this;if(arguments.length>1){for(var c=[],d=0,e=arguments.length;e>d;d++)c[d]=arguments[d];a=c}if("string"===Fancy.typeOf(a))b.$events[a]=b.$events[a]||[];else if("array"===Fancy.typeOf(a))for(var d=0,e=a.length;e>d;d++)b.$events[a[d]]=b.$events[a[d]]||[]},has:function(a){var b=this.$events[a];return b?0!==b.length:!1}})}(),Fancy.define("Fancy.Store",{extend:Fancy.Event,mixins:["Fancy.store.mixin.Paging","Fancy.store.mixin.Proxy","Fancy.store.mixin.Rest","Fancy.store.mixin.Reader","Fancy.store.mixin.Writer","Fancy.store.mixin.Sort","Fancy.store.mixin.Edit","Fancy.store.mixin.Grouping","Fancy.store.mixin.Filter"],pageSize:10,showPage:0,pages:0,autoLoad:!0,dirty:!1,constructor:function(){var a=this;a.Super("const",arguments),a.init(),a.data=a.data||[],a.dataView=a.dataView||[],a.setModel(),a.data&&(a.data.proxy?a.initProxy():a.setData(a.data)),a.init()},init:function(){var a=this;a.addEvents("add","change","changepages","set","beforeupdate","update","remove","beforedestroy","destroy","beforecreate","create","sort","beforeload","load","filter"),a.initId(),a.initPlugins(),a.paging&&a.initPaging()},setModel:function(){var a=this,b=a.model;if(b=void 0===b?Fancy.Model:Fancy.ClassManager.get(a.model),a.model=b,a.fields=b.prototype.fields,void 0===a.fields)throw new Error("needed to set fields in Model of Store")},setData:function(a){var b=this,c=0,d=a.length,e=b.model;if(b.data=[],b.dataView=[],b.dataViewIndexes={},b.collapsed)for(;d>c;c++){var f=new e(a[c]);b.data[c]=f}else if(b.expanded)for(;d>c;c++){var f=new e(a[c]);b.data[c]=f}else for(;d>c;c++){var f=new e(a[c]);b.data[c]=f,b.dataView[c]=f,b.dataViewIndexes[c]=c}},get:function(a,b){var c=this;return void 0===b?c.dataView[a].data:"none"===b?"":c.dataView[a].data[b]},set:function(a,b,c){var d=this,e=d.dataView[a].data.id,f=d.get(a,b,c);if(f!==c)return d.dataView[a].data[b]=c,"server"===d.proxyType?void d.proxyCRUD("UPDATE",e,b,c):void d.fire("set",{rowIndex:a,key:b,value:c})},getLength:function(){return this.dataView.length},getTotal:function(){var a=this;return"server"===a.pageType?a.totalCount:a.filteredData?a.filteredData.length:a.data.length},defineModel:function(a){var b=this,c=b.store;if(!b.model||!b.fields||0===b.fields.length){var a=a||b.data||c.data,d=b.getFieldsFromData(a),e="Fancy.model."+Fancy.id();Fancy.define(e,{extend:Fancy.Model,fields:d}),b.model=e,b.fields=d,b.setModel()}},getFieldsFromData:function(a){var b=a.items||a;if(a.fields)return a.fields;if(!b)throw new Error("not set fields of data");var c=b[0],d=[];for(var e in c)d.push(e);return d},getColumnOriginalValues:function(a,b){var c=this,d=c.data,e=0,f=d.length,g=[];if(b)for(;f>e;e++)g.push(b(d[e].data));else for(;f>e;e++)g.push(d[e].data[a]);return g},changeDataView:function(){var a,b=this,c=[],d=0,e=b.data.length,f=!!b.filters,g=b.data;f&&(b.filterData(),g=b.filteredData,e=g.length),b.dataViewIndexes={},b.paging&&(d="server"===b.pageType?0:b.showPage*b.pageSize,e=d+b.pageSize);var h=b.getTotal();if(e>b.data.length&&(e=b.data.length),f&&e>h&&(e=h),b.order)if(b.grouping)for(a=b.grouping.by;e>d;d++)b.expanded[b.data[b.order[d]].data[a]]&&(f===!0?(b.dataViewIndexes[c.length]=b.filterOrder[d],c.push(g[d])):(b.dataViewIndexes[c.length]=b.order[d],c.push(g[b.order[d]])));else for(;e>d;d++)f===!0?(b.dataViewIndexes[c.length]=b.filterOrder[d],c.push(g[d])):(b.dataViewIndexes[c.length]=b.order[d],c.push(g[b.order[d]]));else if(b.grouping)for(a=b.grouping.by;e>d;d++)b.expanded[d].data[a]&&(b.dataViewIndexes[c.length]=d,c.push(g[d]));else for(;e>d;d++)b.dataViewIndexes[c.length]=d,c.push(g[d]);b.dataView=c,b.fire("change")},getColumnData:function(a,b){var c=this,d=0,e=c.data.length,f=[];if(b)for(;e>d;d++)f.push(b(c.data[d].data));else for(;e>d;d++)f.push(c.data[d].data[a]);return f},getData:function(){for(var a=this,b=0,c=a.data.length,d=[];c>b;b++)d.push(a.data[b].data);return d},getDataView:function(){for(var a=this,b=0,c=a.dataView.length,d=[];c>b;b++)d.push(a.dataView[b].data);return d}}),Fancy.$=$,Fancy.get=function(a){var b=Fancy.typeOf(a);switch(b){case"string":return new Fancy.Element(Fancy.$("#"+a)[0]);case"array":return new Fancy.Elements(a);default:return new Fancy.Element(a)}},Fancy.Element=function(a){var b=this;b.dom=a,b.$dom=Fancy.$(a),b.length=1},Fancy.Element.prototype={closest:function(a){return Fancy.get(this.$dom.closest(a)[0])},destroy:function(){this.$dom.remove()},remove:function(){this.$dom.remove()},prev:function(){return this.$dom.prev()},on:function(a,b,c,d){var e=this;c&&(b=$.proxy(b,c)),d?e.$dom.on(a,d,b):e.$dom.on(a,b)},prop:function(a){return this.$dom.prop(a)},_on:function(a,b,c,d){var e=this;window.addEventListener?"mousewheel"===a&&ZG.mouseWheelWork===!1?e.dom.addEventListener("DOMMouseScroll",b,!1):e.dom.addEventListener(a,b,!1):e.dom.attachEvent("on"+a,b)},un:function(a,b,c,d){var e=this;c&&(b=$.proxy(b,c)),d?e.$dom.off(a,d,b):e.$dom.off(a,b)},getByClass:function(a){var b=this;return b.$dom.find("."+a)[0]},getByTag:function(a){var b=this;return Fancy.get(b.$dom.find(a)[0])},addClass:function(a){var b=this;b.$dom.addClass(a)},removeClass:function(a){var b=this;b.$dom.removeClass(a)},hasClass:function(a){var b=this;return b.$dom.hasClass(a)},toggleClass:function(a){var b=this;b.$dom.toggleClass(a)},select:function(a){var b=this,c=b.$dom.find(a);return 1===c.length?Fancy.get(c[0]):c.length>1?Fancy.get(c):0===c.length?{length:0,dom:void 0,addClass:function(){},removeClass:function(){}}:c},css:function(a,b){return void 0===b?this.$dom.css(a):this.$dom.css(a,b)},attr:function(a,b){return void 0===b?this.$dom.attr(a):this.$dom.attr(a,b)},append:function(a){return this.$dom.append(a)[0]},before:function(a){return this.$dom.before(a)[0]},height:function(){return this.$dom.height()},width:function(){return this.$dom.width()},parent:function(a){return Fancy.get(this.$dom.parent(a)[0])},update:function(a){this.dom.innerHTML=a},hover:function(a,b){this.$dom.hover(a,b)},position:function(){return this.$dom.position()},offset:function(){return this.$dom.offset()},focus:function(){this.$dom.focus()},within:function(a){var b,c=this,d=!0,e=!1;return a=Fancy.get(a),b=a.attr("id"),void 0===b&&(b=Fancy.id(),e=!0),a.attr("id",b),0===c.select("#"+b).length&&(d=!1),c.dom.id===a.dom.id&&(d=!0),e&&c.removeAttr(b),d},removeAttr:function(a){this.$dom.removeAttr(a)},item:function(){return this}},Fancy.Elements=function(a){var b=this;b.dom=a,b.$dom=a,b.length=a.length},Fancy.Elements.prototype={addClass:function(a){for(var b=this,c=0,d=b.length;d>c;c++)Fancy.get(b.$dom[c]).addClass(a)},removeClass:function(a){for(var b=this,c=0,d=b.length;d>c;c++)Fancy.get(b.$dom[c]).removeClass(a)},hover:function(a){var b=this;b.$dom.hover(a)},on:Fancy.Element.prototype.on,item:function(a){return Fancy.get(this.$dom[a])},css:function(a,b){for(var c=this,d=0,e=c.length;e>d;d++)Fancy.get(c.$dom[d]).css(a,b)},toggleClass:function(a){for(var b=this,c=0,d=b.length;d>c;c++)Fancy.get(b.$dom[c]).toggleClass(a)},destroy:function(){for(var a=this,b=0,c=a.length;c>b;b++)Fancy.get(a.$dom[b]).destroy()}},Fancy.select=function(a){return Fancy.get(document.body).select(a)},Fancy.onReady=function(a){$(document).ready(a)},Fancy.Ajax=function(a){var b={};a.url&&(b.url=a.url),a.success&&(b.success=a.success),a.error&&(b.error=a.error),a.method&&(b.type=a.method),a.params&&(b.data=a.params),a.sendJSON&&(b.dataType="json",b.contentType="application/json; charset=utf-8",b.data=JSON.stringify(b.data)),a.getJSON&&(b.dataType="json",b.contentType="application/json; charset=utf-8"),$.ajax(b)},Fancy.ns("Fancy.i18n"),Fancy.i18n.en={paging:{first:"First Page",last:"Last Page",prev:"Previous Page",next:"Next Page",reload:"Reload",rows:"Rows",info:"Rows [0] - [1] of [2]",page:"Page",of:"of [0]"},loadingText:"Loading...",thousandSeparator:",",decimalSeparator:".",currencySign:"$",sourceText:"Source"},Fancy.define("Fancy.Widget",{extend:Fancy.Event,constructor:function(a){var b=this;Fancy.applyConfig(b,a),b.Super("const",arguments),b.init()},init:function(){var a=this;a.initId(),a.addEvents("beforerender","afterrender","render","show","hide","destroy"),a.initPlugins()},renderItems:function(a){for(var b=this,c=0,d=b.items.length;d>c;c++){var e=b.items[c],f=Fancy.getClassByType(e.type);e.renderTo=a,b.items[c]=new f(e)}}}),Fancy.define("Fancy.Plugin",{extend:Fancy.Event,constructor:function(a){var b=this;b.Super("const",arguments),b.init()},init:function(){var a=this;a.initId(),a.addEvents("beforerender","afterrender","render","show","hide","destroy")}}),function(){var a={};Fancy.define("Fancy.Button",{extend:Fancy.Widget,constructor:function(b,c){var d=this;b.toggleGroup&&(a[b.toggleGroup]=a[b.toggleGroup]||{active:!1,items:[]},a[b.toggleGroup].items.push(d)),d.scope=c,d.Super("const",arguments)},init:function(){var a=this;a.addEvents("click","mousedown","mouseup","mouseover","mouseout"),a.Super("init",arguments),a.style=a.style||{},a.initTpl(),a.render(),a.setOns()},setOns:function(){var a=this,b=a.el;b.on("click",a.onClick,a),b.on("mousedown",a.onMouseDown,a),b.on("mouseup",a.onMouseUp,a),b.on("mouseover",a.onMouseOver,a),b.on("mouseout",a.onMouseOut,a)},widgetCls:"fancy-button",cls:"",disabledCls:"fancy-button-disabled",extraCls:"",text:"",height:28,paddingTextWidth:5,tpl:['<div class="fancy-button-image"></div>','<a class="fancy-button-text">{text}</a>'],initTpl:function(){var a=this;a.tpl=new Fancy.Template(a.tpl)},render:function(){var a=this,b=Fancy.get(a.renderTo||document.body).dom,c=Fancy.get(document.createElement("div")),d=0;if(a.fire("beforerender"),a.width?d=a.width:d+=7*a.text.length+14,c.addClass(Fancy.cls),c.addClass(a.widgetCls),c.addClass(a.cls),c.addClass(a.extraCls),a.disabled&&c.addClass(a.disabledCls),c.css({width:d+"px",height:a.height+"px"}),c.update(a.tpl.getHTML({text:a.text})),a.imageCls){var e=c.select(".fancy-button-image");e.css("display","block"),e.addClass(a.imageCls)}a.el=Fancy.get(b.appendChild(c.dom)),Fancy.each(a.style,function(b,c){a.el.css(c,b)}),a.disabled&&a.disable(),a.initToggle(),a.fire("afterrender"),a.fire("render")},initToggle:function(){var a=this;a.enableToggle&&a.setPressed(a.pressed)},setPressed:function(b){var c=this;if(b){if(c.el.addClass("fancy-button-pressed"),c.el.removeClass("fancy-button-not-pressed"),c.pressed=!0,c.toggleGroup){var d=a[c.toggleGroup].active;d&&d.setPressed(!1),a[c.toggleGroup].active=c}}else c.el.addClass("fancy-button-not-pressed"),c.el.removeClass("fancy-button-pressed"),c.pressed=!1},toggle:function(){var a=this,b=!a.pressed;a.setPressed(b),a.pressed=b},onClick:function(){var a=this;a.fire("click"),a.handler&&a.disabled!==!0&&(a.scope?a.handler.apply(a.scope,[a]):a.handler(a))},onMouseDown:function(){var a=this;a.fire("mousedown")},onMouseUp:function(){var a=this;a.fire("mouseup")},onMouseOver:function(){var a=this;a.fire("mouseover")},onMouseOut:function(){var a=this;a.fire("mouseout")},setText:function(a){var b=this;b.el.select(".fancy-button-text").update(a)},disable:function(){var a=this;a.disabled=!0,a.el.addClass(a.disabledCls)},enable:function(){var a=this;a.disabled=!1,a.el.removeClass(a.disabledCls)}})}(),Fancy.define("Fancy.Panel",{extend:Fancy.Widget,constructor:function(){var a=this,b=b||{};Fancy.apply(a,b),a.Super("constructor",arguments)},init:function(){var a=this;a.Super("init",arguments),a.initTpl(),a.render()},cls:"fancy fancy-panel",value:"",width:300,height:200,titleHeight:30,barHeight:37,title:void 0,frame:!1,shadow:!0,tpl:['<div style="height:{titleHeight}px;" class="fancy-panel-header fancy-display-none">','<div class="fancy-panel-header-text">{title}</div>','<div class="fancy-panel-header-tools"></div>',"</div>",'<div class="fancy-panel-body">','<div class="fancy-panel-tbar fancy-display-none" style="height:{barHeight}px;"></div>','<div class="fancy-panel-body-inner"></div>','<div class="fancy-panel-bbar fancy-display-none" style="height:{barHeight}px;"></div>','<div class="fancy-panel-buttons fancy-display-none" style="height:{barHeight}px;"></div>','<div class="fancy-panel-footer fancy-display-none" style="height:{barHeight}px;"></div>',"</div>"],render:function(){var a=this,b=Fancy.get(a.renderTo||document.body),c=Fancy.get(document.createElement("div")),d=0,e=a.titleHeight,f="fancy-display-none";c.addClass(a.cls),"default"!==a.theme&&c.addClass("fancy-theme-"+a.theme),a.shadow&&c.addClass("fancy-panel-shadow"),c.css({width:a.width+"px",height:a.height-d+"px"}),a.style&&c.css(a.style);var g;Fancy.isObject(a.title)?g=a.title.text:Fancy.isString(a.title)&&(g=a.title),c.update(a.tpl.getHTML({barHeight:a.barHeight,titleHeight:e,title:g||""})),Fancy.isObject(a.title)&&a.title.style&&c.select(".fancy-panel-header").css(a.title.style),a.title?c.select(".fancy-panel-header").removeClass(f):c.select(".fancy-panel-body").css("border-top-width","0px"),a.tbar&&c.select(".fancy-panel-tbar").removeClass(f),a.bbar&&c.select(".fancy-panel-bbar").removeClass(f),a.buttons&&c.select(".fancy-panel-buttons").removeClass(f),a.footer&&c.select(".fancy-panel-footer").removeClass(f),a.el=b.dom.appendChild(c.dom),a.el=Fancy.get(a.el),a.modal&&0===Fancy.select("fancy-modal").length&&Fancy.get(document.body).append('<div class="fancy-modal" style="display: none;"></div>'),a.renderTools(),a.renderBars()},renderTools:function(){var a=this,b=a.tools;if(void 0!==b)for(var c=0,d=b.length;d>c;c++)a.tools[c].renderTo=a.el.select(".fancy-panel-header-tools").dom,a.tools[c]=new Fancy.Tool(a.tools[c],a.scope)},initTpl:function(){var a=this;a.tpl=new Fancy.Template(a.tpl)},renderBars:function(){var a,b,c=this;c.bbar&&(a=c.el.select(".fancy-panel-bbar"),b=c.bbar,c.renderBar(a,b,"bbar")),c.tbar&&(a=c.el.select(".fancy-panel-tbar"),b=c.tbar,c.renderBar(a,b,"tbar")),c.footer&&(a=c.el.select(".fancy-panel-footer"),b=c.footer,c.renderBar(a,b,"footer"))},renderBar:function(a,b,c){var d=this,e={};if(0!==b.length){for(var f=0,g=b.length,h=!1,i=[];g>f;f++){var j=b[f],k="left";switch(j.toggleGroup&&(j.enableToggle=!0),Fancy.isObject(j)&&(j.type=j.type||"button"),h&&(k="right"),j.renderTo=a.dom,j){case"|":i.push(new Fancy.Separator({renderTo:a.dom,style:{"float":k,"margin-right":"5px","margin-top":"6px","padding-left":"0px"}}));continue;case"side":h=!0;continue}switch(j.type){case void 0:case"button":j.extraCls="fancy-bar-button";var l=new Fancy.Button(j);0===f&&l.el.addClass("fancy-button-first"),i.push(l),j.role&&(e[j.role]=l);break;case"text":var m={"float":k,"margin-right":"10px","padding-left":"0px"};j.cls||(m["margin-top"]="11px"),Fancy.apply(m,j.style||{});var l=new Fancy.bar.Text({renderTo:a.dom,text:j.text,style:m,cls:j.cls||""});i.push(l),j.role&&(e[j.role]=l);break;case"combo":break;case"number":j.label=!1,j.inputWidth=18,j.value=1,j.style={"float":k,"margin-right":"5px","margin-top":"-4px","padding-left":"0px"};var l=new Fancy.NumberField(j);j.role&&(e[j.role]=l),i.push(l)}}d[c]=i,d[c+"Roles"]=e}}}),Fancy.define("Fancy.Tool",{extend:Fancy.Widget,constructor:function(a,b){var c=this;c.scope=b,c.Super("const",arguments)},init:function(){var a=this;a.addEvents("click","mousedown","mouseup","mouseover","mouseout"),a.Super("init",arguments),a.style=a.style||{},a.render(),a.setOns()},setOns:function(){var a=this,b=a.el;b.on("click",a.onClick,a)},cls:"fancy fancy-button",text:"",height:28,paddingTextWidth:5,render:function(){var a=this,b=Fancy.get(a.renderTo||document.body).dom,c=document.createElement("div");a.fire("beforerender"),c.className="fancy-tool-button",c.innerHTML=a.text,a.el=Fancy.get(b.appendChild(c)),a.fire("afterrender"),a.fire("render")},onClick:function(){var a=this;a.fire("click"),a.handler&&(a.scope?a.handler.apply(a.scope,[a]):a.handler(a))},setText:function(a){var b=this;b.el.update(a)}}),Fancy.define("Fancy.Separator",{cls:"fancy-separator",constructor:function(a){var b=this,a=a||{};Fancy.apply(b,a),b.init()},init:function(){var a=this;a.render()},render:function(){var a=this,b=Fancy.get(document.createElement("div"));b.addClass(a.cls),b.update("<div></div>"),a.el=Fancy.get(a.renderTo.appendChild(b.dom)),a.style&&a.el.css(a.style)}}),Fancy.define("Fancy.bar.Text",{widgetCls:"fancy-bar-text",cls:"",text:"",constructor:function(a){var b=this,a=a||{};Fancy.apply(b,a),b.init()},init:function(){var a=this;a.render()},render:function(){var a=this,b=Fancy.get(document.createElement("div"));b.addClass(a.widgetCls),b.addClass(a.cls),b.update(a.text),a.el=Fancy.get(a.renderTo.appendChild(b.dom)),a.style&&a.el.css(a.style)}}),Fancy.ns("Fancy.form.field"),Fancy.form.field.Mixin=function(){},Fancy.form.field.Mixin.prototype={vtypes:{},ons:function(){var a=this,b=a.el.getByTag("input");a.input=b,b.on("blur",a.onBlur,a),b.on("focus",a.onFocus,a),b.on("input",a.onInput,a),b.on("keydown",a.onKeyDown,a),a.on("key",a.onKey,a)},prepareValid:function(){var a=this,b=a.valid,c=a.vtypes;if(b&&b.type){var d=c[b.type];if(!d)throw new Error("not right validation type - "+b.type);Fancy.applyIf(a.valid,d)}},render:function(){var a=this,b=a.renderTo||document.body,c=document.createElement("div"),d=a.style;a.prepareValid(),a.fire("beforerender"),c.className=a.cls,c.id=a.id;var e="",f="",g="";a.itemsHTML&&(g=a.itemsHTML),"top"===a.labelAlign&&a.label&&a.labelWidth<7*a.label.length&&(a.labelWidth=7*(a.label.length+2)),a.labelWidth&&(e="width:"+a.labelWidth+"px;"),a.inputWidth&&(f="width:"+a.inputWidth+"px;");var h=a.label;""===a.label?h="&nbsp;":void 0===a.label?h="&nbsp;":"right"!==a.labelAlign&&(h+=":");var i="",j="",k="",l=a.labelWidth||0;l+=11,"top"===a.labelAlign&&(l=2),a.label===!1&&(i="display:none;"),a.inputLabel?k=a.inputLabel:j="display:none;","recaptcha"===a.type?c.innerHTML=a.tpl.getHTML({key:a.key}):c.innerHTML=a.tpl.getHTML({labelWidth:e,label:h,labelDisplay:i,inputLabelDisplay:j,inputLabel:k,emptyText:a.emptyText,inputWidth:f,value:a.value,height:a.height,itemsHTML:g,errorTextStyle:""}),d&&Fancy.get(c).css(d),a.renderId===!0&&(c.id=a.id),a.el=b.appendChild(c),a.el=Fancy.get(a.el),"top"===a.labelAlign?(a.el.addClass("fancy-field-label-align-top"),a.el.select(".fancy-field-text").css("float","none")):"right"===a.labelAlign?(a.el.addClass("fancy-field-label-align-right"),$(c).find(".fancy-field-label").insertAfter($(c).find(".fancy-field-text"))):"radio"!==a.type,a.acceptedValue=a.value,a.fire("afterrender"),a.fire("render"),"recaptcha"!==a.type&&"chat"!==a.type&&setTimeout(function(){a.input&&0===a.input.dom.value.length&&(void 0===a.prevColor&&(a.prevColor=a.input.css("color")),a.input.css("color","grey"))},1)},onKeyDown:function(a){var b=this,c=a.keyCode,d=Fancy.key;if("number"===b.type&&Fancy.Key.isNumControl(c,a)===!1)return a.preventDefault(),void a.stopPropagation();switch(c){case d.ENTER:b.fire("enter",b.getValue()),"textarea"!==b.type&&(a.preventDefault(),a.stopPropagation());break;case d.UP:if("number"===b.type){var e=+b.get()+b.step;isNaN(e)&&(e=b.min||0),void 0!==b.max&&e>b.max?e=b.max:e<b.min&&(e=b.min),b.set(e)}b.fire("up",b.getValue()),"textarea"!==b.type&&(a.preventDefault(),a.stopPropagation());break;case d.DOWN:if("number"===b.type){var e=+b.get()-b.step;isNaN(e)&&(e=b.min||0),void 0!==b.min&&e<b.min?e=b.min:e>b.max&&(e=b.max),b.set(e)}b.fire("up",b.getValue()),"textarea"!==b.type&&(a.preventDefault(),a.stopPropagation());break;case d.LEFT:break;case d.RIGHT:a.stopPropagation();break;default:setTimeout(function(){b.input&&(0===b.input.dom.value.length?(void 0===b.prevColor&&(b.prevColor=b.input.css("color")),
b.input.css("color","grey")):b.prevColor?b.input.css("color",b.prevColor):b.input.css("color"," "))},1)}setTimeout(function(){b.fire("key",b.getValue(),a)},1)},onKey:function(){var a=this,b=a.valid;b&&b.type&&a.validate()},onBlur:function(){var a=this,b=a.el,c=a.valid,d=!0;return c&&(c.blank===!1&&("combo"===a.type&&0===a.get()||0===a.get().length)?(b.addClass("fancy-field-blank-err"),b.hasClass("fancy-field-not-valid")&&(b.removeClass("fancy-field-not-valid"),b.css("height",parseInt(b.css("height"))-6+"px")),c.blankText&&(b.css("height",parseInt(b.css("height"))+6+"px"),b.select(".fancy-field-error").update(c.blankText))):c.type?a.validate():(b.removeClass("fancy-field-blank-err"),b.removeClass("fancy-field-not-valid"))),b.hasClass("fancy-field-blank-err")&&(d=!1),b.hasClass("fancy-field-not-valid")&&(d=!1),a.fire("blur"),d},onFocus:function(){var a=this,b=a.el;b.hasClass("fancy-field-blank-err")&&(a.el.removeClass("fancy-field-blank-err"),a.valid.blankText&&b.css("height",parseInt(b.css("height"))-6+"px")),a.fire("focus")},onInput:function(){var a=this,b=(a.input,a.getValue());a.acceptedValue=a.get(),a.fire("input",b),a.fire("change",b)},get:function(){var a=this;return a.input.dom.value},getValue:function(){return this.get()},set:function(a,b){var c=this;c.input.dom.value=a,b!==!1&&c.onInput()},setValue:function(a,b){this.set(a,b)},clear:function(){this.set("")},validate:function(){var a=this,b=a.el,c=a.valid,d=a.vtypes,e=d[c.type];if(!e)throw new Error("not right validation type - "+c.type);var f=a.get(),g=b.hasClass("fancy-field-not-valid");e.fn?e.fn(f)?b.removeClass("fancy-field-not-valid"):b.addClass("fancy-field-not-valid"):e.re&&(e.re.test(f)?b.removeClass("fancy-field-not-valid"):b.addClass("fancy-field-not-valid"));var h=b.hasClass("fancy-field-not-valid");return g===!1&&h===!0&&c.text&&b.css("height",parseInt(b.css("height"))+6+"px"),g===!0&&h===!1&&c.text&&b.css("height",parseInt(b.css("height"))-6+"px"),h&&b.select(".fancy-field-error").update(c.text),h},setInputSize:function(a){var b=this;a.width&&b.input.css("width",a.width),a.height&&b.input.css("height",a.height)},focus:function(){var a=this;a.input.focus()},hide:function(){var a=this;a.el.css("display","none")},show:function(){var a=this;a.el.css("display","block")}},Fancy.define(["Fancy.form.field.String","Fancy.StringField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.string",constructor:function(a){var b=this,a=a||{};Fancy.apply(b,a),b.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","change","key"),a.Super("init",arguments),a.tpl=new Fancy.Template(a.tpl),a.render(),a.ons(),a.isPassword&&a.input.attr({type:"password"}),a.hidden&&a.el.css("display","none"),a.style&&a.el.css(a.style)},cls:"fancy fancy-field",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}" value="{value}">','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>']}),Fancy.define(["Fancy.form.field.Number","Fancy.NumberField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.number",allowBlank:!0,constructor:function(a){var b=this,a=a||{};Fancy.apply(b,a),b.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","change","key"),a.Super("init",arguments),a.tpl=new Fancy.Template(a.tpl),a.render(),a.ons(),a.hidden&&a.el.css("display","none"),a.style&&a.el.css(a.style)},cls:"fancy fancy-field",value:"",width:100,emptyText:"",step:1,max:1e20,min:-1e20,tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}" value="{value}">','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>'],onInput:function(){var a=this,b=(a.input,a.get()),c=a.checkMinMax(b);(a.isNumber(b)===!1||"-"===b||"+"===b)&&(c=!1),""===b&&a.allowBlank?c=!0:""===b&&a.allowBlank===!1&&(c=!1,a.el.addClass("fancy-field-not-valid")),c&&(a.acceptedValue=a.get(),a.el.removeClass("fancy-field-not-valid")),a.fire("input",b),a.fire("change",b)},isNumber:function(a){return""===a||"-"===a?!0:Fancy.isNumber(+a)},checkMinMax:function(a){if(""===a||"-"===a)return!0;var b=this,a=+a;return a>=b.min&&a<=b.max},setMin:function(a){var b=this;b.min=a},setMax:function(a){var b=this;b.max=a}}),Fancy.define(["Fancy.form.field.CheckBox","Fancy.CheckBox"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.checkbox",constructor:function(){var a=this;a.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","up","down","beforechange","change","key"),a.Super("init",arguments),a.tpl=new Fancy.Template(a.tpl),a.render({labelWidth:a.labelWidth,labelDispay:a.labelText?"":"none",label:a.label}),a.acceptedValue=a.value,a.set(a.value,!1),a.ons()},labelText:"",labelWidth:60,value:!1,checkedCls:"fancy-checkbox-on",cls:"fancy fancy-field fancy-field-checkbox",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<div class="fancy-field-checkbox-input" style=""></div>',"</div>",'<div class="fancy-field-input-label" style="inputLabelDisplay">',"{inputLabel}","</div>",'<div class="fancy-clearfix"></div>'],ons:function(){var a=this,b=a.el;b.on("click",a.onClick,a),b.on("mousedown",a.onMouseDown,a)},onClick:function(){var a=this,b=a.el,c=a.checkedCls;return a.fire("beforechange"),a.canceledChange===!0?void(a.canceledChange=!0):(b.toggleClass(c),a.value=b.hasClass(c),void a.fire("change",a.value))},onMouseDown:function(a){a.preventDefault()},set:function(a,b){var c=this,d=c.el,e=c.checkedCls;if(a===!0||1===a)d.addClass(e),a=!0;else{if(a!==!1&&0!==a)throw new Error("not right value for checkbox "+a);d.removeClass(e),a=!1}c.value=a,b!==!1&&c.fire("change",c.value)},setValue:function(a,b){this.set(a,b)},getValue:function(){var a=this;return a.value},get:function(){return this.getValue()},clear:function(){this.set(!1)},toggle:function(){var a=this;a.set(!a.value)}}),Fancy.define(["Fancy.form.field.Combo","Fancy.Combo"],{type:"field.combo",mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,activeListItemCls:"fancy-combo-list-active",width:250,height:28,labelWidth:60,inputWidth:180,inputHeight:30,listRowHeight:25,dropButtonWidth:20,widthToInput:!1,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">',"<div>",'<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}{inputHeight}cursor:default;" value="{value}">','<div class="fancy-combo-dropdown-button">&nbsp;</div>',"</div>",'<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>'],constructor:function(){var a=this;a.tags=a.tags||[],a.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","up","down","change","key"),a.Super("init",arguments),a.calcSize(),a.tpl=new Fancy.Template(a.tpl),a.render(),a.ons(),a.applySize(),a.applyStyle(),a.applyTheme()},calcSize:function(){var a=this;a.inputHeight=a.height,a.label===!1||"top"===a.labelAlign?a.inputWidth=a.width:a.inputWidth=a.width-a.labelWidth,"top"===a.labelAlign&&(a.height*=1.5)},applySize:function(){var a=this;a.el.css({width:a.width,height:a.height})},applyStyle:function(){var a=this;a.hidden&&a.el.css("display","none"),a.style&&a.el.css(a.style)},applyTheme:function(){var a=this;a.theme&&"default"!==a.theme&&(a.el.addClass("fancy-theme-"+a.theme),a.list.addClass("fancy-theme-"+a.theme))},cls:"fancy fancy-field fancy-combo",ons:function(){var a=this,b=a.el.select(".fancy-combo-dropdown-button");a.input=a.el.getByTag("input"),a.drop=b,a.onsList(),a.input.on("mousedown",a.onInputMouseDown,a),a.input.on("click",a.onInputClick,a),b.on("mousedown",a.onDropMouseDown,a),b.on("click",a.onDropClick,a)},onInputClick:function(a){var b=this,c=b.list;"none"===c.css("display")?b.showList():b.hideList()},onDropClick:function(a){var b=this,c=b.list;"none"===c.css("display")?b.showList():b.hideList()},showList:function(){var a=this,b=a.list,c=a.input.parent().parent(),d=c.$dom.offset(),e=[d.left,d.top+c.$dom.height()],f=Fancy.get(document);b.css({display:"",left:e[0]+"px",top:e[1]+"px",width:c.width(),"z-index":2e3+Fancy.zIndex++}),a.docSpy||(a.docSpy=!0,f.on("click",a.onDocClick,a))},onDocClick:function(a){var b=this;b.input.parent().parent().within(a.target)===!1&&b.hideList()},hideList:function(){var a=this;if(a.list.css("display","none"),a.docSpy){var b=Fancy.get(document);a.docSpy=!1,b.un("click",a.onDocClick,a)}},onInputMouseDown:function(a){a.preventDefault()},onDropMouseDown:function(a){a.preventDefault()},onsList:function(){var a=this,b=a.list,c=(a.input,b.select("li"));c.hover(function(b){a.listItemOver&&a.listItemOver.removeClass("fancy-combo-list-active"),Fancy.get(b.target).addClass("fancy-combo-list-active"),a.listItemOver=Fancy.get(b.target)}),c.on("click",a.onListItemClick,a)},onListItemClick:function(a){var b=this,c=Fancy.get(a.currentTarget),d=c.attr("value");b.set(d),b.hideList(),b.onBlur()},set:function(a,b){for(var c=this,d="",e=0,f=c.data.length,g=!1;f>e;e++)if(c.data[e][c.valueKey]==a){c.valueIndex=e,d=c.data[e][c.displayKey],g=!0;break}g===!1&&(d=""),c.input.dom.value=d,c.value=a,b!==!1&&c.onInput()},render:function(){var a=this,b=Fancy.get(a.renderTo||document.body).dom,c=Fancy.get(document.createElement("div")),d=Fancy.get(document.createElement("div")),e=a.value,f=a.inputWidth;if(a.widthToInput===!1&&(f-=a.dropButtonWidth),void 0===e)e="";else{for(var g=0,h=a.data.length,i=!1;h>g;g++)if(a.data[g][a.valueKey]===e){a.valueIndex=g,e=a.data[g][a.displayKey],i=!0;break}i===!1&&(e="")}a.fire("beforerender"),c.addClass(a.cls);var j="";a.labelWidth&&(j="width:"+a.labelWidth+"px;");var k=a.labelWidth+8+10;"top"===a.labelAlign&&(k=8),"right"===a.labelAlign&&(k=8);var l=['<ul style="position: relative;">'];Fancy.each(a.data,function(b,c){var d="",e=b[a.displayKey];0===c&&(d="fancy-combo-list-active"),(""===e||" "===e)&&(e="&nbsp;"),l.push('<li value="'+b[a.valueKey]+'" class="'+d+'"><span class="fancy-combo-list-value">'+e+"</span></li>")}),l.push("</ul>");var m=a.label;""===a.label?m="&nbsp;":void 0===a.label?m="&nbsp;":"right"!==a.labelAlign&&(m+=":"),c.update(a.tpl.getHTML({labelWidth:j,labelDisplay:a.label===!1?"display: none;":"",label:m===!1?"":m,emptyText:a.emptyText,inputWidth:"width:"+f+"px;",inputHeight:"height:"+a.inputHeight+"px;",value:e,height:a.height})),b.appendChild(c.dom),a.el=c,d.addClass("fancy fancy-combo-result-list"),d.update(l.join("")),d.css({display:"none",left:"0px",top:"0px",width:a.inputWidth+14}),a.data.length>9&&d.css({height:9*a.listRowHeight+"px",overflow:"auto"}),document.body.appendChild(d.dom),a.list=d,"top"===a.labelAlign?a.el.addClass("fancy-field-label-align-top"):"right"===a.labelAlign&&(a.el.addClass("fancy-field-label-align-right"),$(c).find(".fancy-field-label").insertAfter($(c).find(".fancy-combo-text"))),a.valueIndex&&(a.acceptedValue=a.value),a.fire("afterrender"),a.fire("render")},hide:function(){var a=this;a.el.css("display","none"),a.hideList()},clear:function(){var a=this;a.set(-1,!1)},clearListActive:function(){var a=this,b=a.activeListItemCls;a.list.select("."+b).removeClass(b)},onInput:function(){var a=this,b=a.getValue();a.acceptedValue=a.get(),a.fire("change",b)},setData:function(a){var b=this,c=[],d=b.activeListItemCls;b.data=a,Fancy.each(b.data,function(a,e){var f="",g=a[b.displayKey];0===e&&(f=d),(""===g||" "===g)&&(g="&nbsp;"),c.push('<li value="'+a[b.valueKey]+'" class="'+f+'">'+g+"</li>")}),b.list.select("ul").update(c.join("")),b.onsList()},setValue:function(a,b){this.set(a,b)},getDisplayValue:function(a){for(var b=this,c=0,d=b.data.length;d>c;c++)if(b.data[c][b.valueKey]==a)return b.data[c][b.displayKey]},getValueKey:function(a){for(var b=this,c=0,d=b.data.length;d>c;c++)if(b.data[c][b.displayKey]===a)return b.data[c][b.valueKey]},get:function(){return this.getValue()},getValue:function(){var a=this;return-1===a.value||void 0===a.value?"":void 0!==a.valueKey?a.value:a.value},size:function(a){var b=this,c=a.width,d=a.height,e=b.input,f=b.drop;e.css("width",c),e.css("height",d),f.css("height",d)}}),Fancy.define(["Fancy.form.field.Radio","Fancy.Radio"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.radio",constructor:function(){var a=this;a.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","up","down","change","key"),a.Super("init",arguments),a.tpl=new Fancy.Template(a.tpl);var b="",c=a.items,d=0,e=c.length;for(a.column&&(a.cls+=" fancy-field-radio-column",b+='<div style="margin-left: '+(a.labelWidth+10)+'px;">');e>d;d++){var f=c[d],g="",h="fancy-field-text";a.column||0===d||(g="margin-left:10px;"),f.value===a.value&&(h+=" fancy-field-radio-on"),b+=['<div class="'+h+'" value='+f.value+">",'<div class="fancy-field-radio-input" style="float:left;'+g+'"></div>','<div style="float:left;margin:7px 0px 0px 0px;">'+f.text+"</div>","</div>"].join("")}a.column&&(b+="</div>"),a.itemsHTML=b,a.render(),a.acceptedValue=a.value,a.set(a.value),a.ons()},labelText:"",labelWidth:60,value:!1,checkedCls:"fancy-field-radio-on",cls:"fancy fancy-field fancy-field-radio",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}",'<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>","{itemsHTML}",'<div class="fancy-clearfix"></div>'],ons:function(){var a=this,b=a.el;b.$dom.delegate(".fancy-field-text","click",function(){a.set(Fancy.get(this).attr("value"))}),b.on("mousedown",a.onMouseDown,a)},onClick:function(){var a=this,b=a.el,c=a.checkedCls;a.addClass(c),b.toggleClass(c),a.value=b.hasClass(c),a.fire("change",a.value)},onMouseDown:function(a){a.preventDefault()},set:function(a,b){var c=this,d=c.el,e=c.checkedCls,f=d.select(".fancy-field-text");f.removeClass(e),d.select("[value="+a+"]").addClass(e),c.value=a,b!==!1&&c.fire("change",c.value)},setValue:function(a,b){this.set(a,b)},getValue:function(){var a=this;return a.value},get:function(){return this.getValue()},clear:function(){this.set(!1)}}),Fancy.Mixin("Fancy.grid.mixin.PrepareConfig",{prepareConfig:function(a,b){var c=this;return a._plugins=a._plugins||[],a=c.prepareConfigTheme(a,b),a=c.prepareConfigLang(a,b),a=c.prepareConfigPaging(a,b),a=c.prepareConfigGrouping(a),a=c.prepareConfigGroupHeader(a),a=c.prepareConfigSorting(a),a=c.prepareConfigEdit(a),a=c.prepareConfigSelection(a),a=c.prepareConfigLoadMask(a,b),a=c.prepareConfigDefaults(a),a=c.prepareConfigFilter(a),a=c.prepareConfigSmartIndex(a),a=c.prepareConfigActionColumn(a),a=c.prepareConfigChart(a,b),a=c.prepareConfigCellTip(a),a=c.prepareConfigColumns(a),a=c.prepareConfigColumnsResizer(a),a=c.prepareConfigTBar(a),a=c.prepareConfigFooter(a)},prepareConfigTheme:function(a,b){var c=a.theme||b.theme,d=Fancy.getTheme(c).config;return Fancy.applyIf(a,d),a},prepareConfigLoadMask:function(a){a.data;return a._plugins.push({type:"grid.loadmask"}),a},reConfigStore:function(a){var b=this,c=b.store,d=b.getFieldsFromData(a),e="Fancy.model."+Fancy.id();Fancy.define(e,{extend:Fancy.Model,fields:d}),b.model=e,c.model=e,b.fields=d,c.fields=d,c.setModel()},prepareConfigDefaults:function(a){if(!a.defaults)return a;for(var b in a.defaults)for(var c=0,d=a.columns.length;d>c;c++)void 0===a.columns[c][b]&&(a.columns[c][b]=a.defaults[b]);return a},prepareConfigCellTip:function(a){for(var b=a.columns,c=0,d=b.length;d>c;c++){var e=b[c];if(e.cellTip){a._plugins.push({type:"grid.celltip"});break}}return a},prepareConfigColumns:function(a){for(var b=a.columns,c=[],d=[],e=0,f=b.length;f>e;e++){var g=b[e];g.locked?(c.push(g),b.splice(e,1),e--,f--):g.rightLocked&&(d.push(g),b.splice(e,1),e--,f--)}return a.leftColumns=c,a.rightColumns=d,a},prepareConfigActionRender:function(a){return function(b){for(var c=a.items||[],d=0,e=c.length;e>d;d++){var f=c[d],g=f.text||"",h=Fancy.styleToString(f.style),i=f.cls||"";b.value+=['<div class="fancy-grid-column-action-item '+i+'" style="'+h+'">',g,"</div>"].join(" ")}return b}},prepareConfigSmartIndex:function(a){for(var b=a.columns,c=0,d=b.length;d>c;c++){var e=b[c];if(/\+|\-|\/|\*|\[/.test(e.index)){isSmartIndex=!0;var f=e.index;f=f.replace(/(\w+)/g,function(a){return isNaN(Number(a))?"data."+a:a}),f="return "+f+";",e.smartIndexFn=new Function("data",f)}}return a},prepareConfigActionColumn:function(a){for(var b=this,c=a.columns,d=0,e=c.length;e>d;d++){var f=c[d];if("action"===f.type){f.sortable=!1,f.editable=!1,f.render=b.prepareConfigActionRender(f);var g=f.items;if(void 0!==g&&0!==g.length)for(var h,i=0,j=g.length;j>i;i++)switch(h=g[i],h.action){case"remove":void 0===h.handler&&(h.handler=function(a,b){a.remove(b)})}}}return a},prepareConfigSorting:function(a){var b=a.defaults||{};if(b.sortable)return a._plugins.push({type:"grid.sorter"}),a;for(var c=0,d=a.columns.length;d>c;c++){var e=a.columns[c];e.sortable&&a._plugins.push({type:"grid.sorter"})}return a},prepareConfigSelection:function(a){var b=!1,c={type:"grid.selection"};return(a.trackOver||a.columnTrackOver||a.cellTrackOver)&&(b=!0),a.selModel&&(b=!0,a.selection=a.selection||{},a.selection.selModel=a.selModel,a.selection[a.selModel]=!0),a.selection&&(b=!0,Fancy.isObject(a.selection)&&Fancy.apply(c,a.selection)),b===!0&&a._plugins.push(c),a},prepareConfigEdit:function(a){var b=a.defaults||{},c={type:"grid.edit"},d=!1;a.clicksToEdit&&(c.clicksToEdit=a.clicksToEdit),b.editable&&(a._plugins.push(c),a._plugins.push({type:"grid.celledit"}),d=!0);for(var e=0,f=a.columns.length;f>e;e++){var g=a.columns[e];switch(void 0===g.index&&void 0===g.key&&(g.editable=!1),g.type){case"image":g.sortable=!1;break;case"sparklineline":case"sparklinebar":case"sparklinetristate":case"sparklinediscrete":case"sparklinebullet":case"sparklinepie":case"sparklinebox":g.editable=!1,g.sortable=!1}g.editable&&d===!1&&(a._plugins.push(c),a._plugins.push({type:"grid.celledit"}))}return a},prepareConfigLang:function(a,b){var c=b.i18n||a.i18n,d=Fancy.Object.copy(Fancy.i18n[c]);if(a.lang){a.lang.paging&&Fancy.apply(d.paging,a.lang.paging);for(var e in a.lang.paging)"paging"!==e&&(Fancy.isObject(e)||(d[e]=a.lang.paging[e]))}return a.lang=d,a},prepareConfigGrouping:function(a){if(a.grouping){var b=a.grouping;Fancy.apply(b,{type:"grid.grouping",collapsed:!0}),a.collapsed=!0,a.expanded={},a._plugins.push(b)}return a},prepareConfigFilter:function(a){var b=a.columns,c=0,d=b.length,e=!1,f=!1,g={type:"grid.filter"};for(a.filter&&(a.filter===!0&&(a.filter={}),Fancy.apply(g,a.filter));d>c;c++){var h=b[c];h.filter&&(e=!0,h.filter.header&&(f=!0))}return g.header=f,e&&a._plugins.push(g),a},prepareConfigGroupHeader:function(a){for(var b=a.columns,c=0,d=b.length,e=[],f=!1,g=[];d>c;c++){var h=b[c];h.columns&&(f=!0,e.push(h))}if(f){c=0;for(;d>c;c++){var h=b[c];if(h.columns){for(var i=0,j=h.columns.length,k=h.text||"  ";j>i;i++)h.locked&&(h.columns[i].locked=!0),h.rightLocked&&(h.columns[i].rightLocked=!0),h.columns[i].grouping=k;g=g.concat(h.columns),f=!0,e.push(h)}else g=g.concat(b.slice(c,c+1))}a.columns=g,a._plugins.push({type:"grid.groupheader",groups:e}),a.isGroupedHeader=!0}return a},prepareConfigPaging:function(a,b){var c=this,d={"float":"left","margin-right":"5px","margin-top":"3px"},e="fancy-bar-button-disabled",f=a.lang;return void 0===a.paging?a:(a._plugins.push({i18n:b.i18n,type:"grid.paging"}),a.bbar=[{imageCls:"fancy-paging-first",disabledCls:e,role:"first",handler:function(a){c.paging.firstPage()},style:{"float":"left","margin-left":"5px","margin-right":"5px","margin-top":"3px"}},{imageCls:"fancy-paging-prev",disabledCls:e,role:"prev",handler:function(){c.paging.prevPage()},style:d},"|",{type:"text",text:f.paging.page},{type:"number",style:d,role:"pagenumber",min:1,listeners:[{enter:function(a){c.paging.setPage(parseInt(a.getValue())-1)}}]},{type:"text",text:"",role:"ofText"},"|",{imageCls:"fancy-paging-next",disabledCls:e,role:"next",style:d,handler:function(){c.paging.nextPage()}},{imageCls:"fancy-paging-last",disabledCls:e,role:"last",style:d,handler:function(){c.paging.lastPage()}},{type:"combo"},"side",{type:"text",role:"info",text:""}],a)},prepareConfigColumnsResizer:function(a){var b=a.defaults||{};if(b.resizable)return a._plugins.push({type:"grid.columnresizer"}),a;for(var c=0,d=a.columns.length;d>c;c++){var e=a.columns[c];e.resizable&&a._plugins.push({type:"grid.columnresizer"})}return a},prepareConfigTBar:function(a){var b=this,c=a.tbar;if(c)for(var d=0,e=c.length;e>d;d++)switch(c[d].action){case"add":void 0===c[d].handler&&(c[d].handler=function(){b.insert(0,{})});break;case"remove":void 0===c[d].handler&&(c[d].disabled=!0,c[d].handler=function(){for(var a=b.getSelection(),c=a.items,d=0,e=a.items.length;e>d;d++){var f=c[d];b.remove(f)}b.selection.clearSelection()},c[d].events=[{render:function(){var a=this;setTimeout(function(){var b=Fancy.getWidget(a.el.parent().parent().select(".fancy-grid").dom.id);b.on("select",function(){a.enable()}),b.on("clearselect",function(){a.disable()})},10)}}])}return a},prepareConfigFooter:function(a){var b=a.footer,c=a.lang;if(b){var d=[];if(Fancy.isString(b.status)&&d.push({type:"text",text:b.status,cls:"fancy-footer-status"}),b.status&&b.source&&d.push("side"),Fancy.isString(b.source))d.push({type:"text",text:b.source,cls:"fancy-footer-source"});else if(Fancy.isObject(b.source)){var e=b.source.text;if(b.source.link){var f=b.source.link;f=f.replace("http://",""),f="http://"+f,e='<span class="fancy-status-source-text">'+c.sourceText+'</span>: <a class="fancy-status-source-link" href="'+f+'">'+e+"</a>"}else e="<span>"+c.sourceText+":</span> "+e;d.push({type:"text",text:e,cls:"fancy-footer-source"})}a.footer=d}return a},prepareConfigChart:function(a){var b=a.data,c=b.chart;if(Fancy.isObject(c)&&(c=[c]),b&&b.chart){a._plugins.push({type:"grid.chartintegration",chart:c,toChart:b.items?!0:b.proxy?!0:!1});for(var d=0,e=c.length;e>d;d++){var f=c[d],g=f.type;switch(g){case"highchart":case"highcharts":a._plugins.push({type:"grid.highchart"});break;case void 0:throw new Error("[FancyGrid Error] - type of chart is undefined");default:throw new Error("[FancyGrid Error] - type of chart "+g+" does not exist")}}}return a}}),Fancy.Mixin("Fancy.grid.mixin.ActionColumn",{initActionColumnHandler:function(){var a=this;a.on("cellclick",a.onCellClickColumnAction,a)},onCellClickColumnAction:function(a,b){var c,d,e=this,f=b.column,g=(Fancy.get(b.cell),b.e.target,f.items);"action"===f.type&&(c=e.getActiveActionColumnItem(b),g&&void 0!==c&&(d=g[c],d.handler&&d.handler(e,b)))},getActiveActionColumnItem:function(a){for(var b=Fancy.get(a.cell),c=a.e.target,d=b.select(".fancy-grid-column-action-item"),e=0,f=d.length;f>e;e++)if(d.item(e).within(c))return e}}),Fancy.define("Fancy.Grid",{extend:Fancy.Widget,mixins:[Fancy.grid.mixin.PrepareConfig,Fancy.grid.mixin.ActionColumn,"Fancy.grid.mixin.Edit"],plugins:[{type:"grid.updater"},{type:"grid.scroller"},{type:"grid.licence"}],type:"grid",prefix:"fancy-grid-",theme:"default",cls:"fancy-grid",cellCls:"fancy-grid-cell",cellInnerCls:"fancy-grid-cell-inner",cellEvenCls:"fancy-grid-cell-even",clsASC:"fancy-grid-column-sort-ASC",clsDESC:"fancy-grid-column-sort-DESC",clsSparkColumn:"fancy-grid-column-sparkline",clsSparkColumnBullet:"fancy-grid-column-sparkline-bullet",clsSparkColumnCircle:"fancy-grid-column-chart-circle",clsSparkColumnDonutProgress:"fancy-grid-column-spark-progress-donut",clsColumnGrossLoss:"fancy-grid-column-grossloss",clsGroupRow:"fancy-grid-group-row",clsCollapsedRow:"fancy-grid-group-row-collapsed",rowOverCls:"fancy-grid-cell-over",cellOverCls:"fancy-grid-cell-over",cellSelectedCls:"fancy-grid-cell-selected",columnOverCls:"fancy-grid-column-over",columnSelectedCls:"fancy-grid-column-selected",filterHeaderCellCls:"fancy-grid-header-filter-cell",cellHeaderDoubleSize:"fancy-grid-header-cell-double-size",header:!0,shadow:!0,striped:!0,columnLines:!0,textSelection:!1,i18n:"en",width:200,height:200,tpl:['<div class="fancy-grid-left fancy-grid-left-empty"></div>','<div class="fancy-grid-center"></div>','<div class="fancy-grid-right fancy-grid-right-empty"></div>','<div class="fancy-grid-editors"></div>'],constructor:function(a){var b=this,a=a||{};a=b.prepareConfig(a,b),Fancy.applyConfig(b,a),b.Super("const",arguments)},init:function(){var a=this;return a.initId(),a.addEvents("beforerender","afterrender","render","show","hide","destroy"),a.addEvents("headercellclick","headercellmousemove","headercellmousedown","docmouseup","docclick","docmove","init","columnresize","columnclick","columndblclick","columnenter","columnleave","columnmousedown","cellclick","celldblclick","cellenter","cellleave","cellmousedown","rowclick","rowdblclick","rowenter","rowleave","scroll","remove","set","sort","beforeload","load","select","clearselect"),a.disableModuleLoad!==!0&&a.fullBuilt!==!0&&a.neededModules!==!0?void a.loadModules():(a.initStore(),a.initPlugins(),a.ons(),a.fire("beforerender"),a.preRender(),a.render(),a.initElements(),a.initActionColumnHandler(),a.fire("render"),a.fire("afterrender"),a.setSides(),a.setSidesHeight(),a.setColumnsPosition(),a.update(),a.initTextSelection(),a.initTouch(),void a.fire("init"))},initStore:function(){var a,b,c=this,d=c.getFieldsFromData(c.data),e="Fancy.model."+Fancy.id(),f=c.data,g=!1;c.data.items&&(f=c.data.items),a=c.data.remoteSort,b=c.data.remoteFilter,Fancy.define(e,{extend:Fancy.Model,fields:d}),c.grouping&&(g=!0);var h={widget:c,model:e,data:f,paging:c.paging,remoteSort:a,remoteFilter:b,collapsed:g};f.pageSize&&(h.pageSize=f.pageSize),c.store=new Fancy.Store(h),c.model=e,c.fields=d},initTouch:function(){var a=this;Fancy.isTouch&&window.FastClick&&(a.panel?(FastClick.attach(a.panel.el.dom),a.panel.el.addClass("fancy-touch")):(FastClick.attach(a.el.dom),a.el.addClass("fancy-touch")))},initElements:function(){var a=this;a.header!==!1&&(a.leftHeader=new Fancy.grid.Header({widget:a,side:"left"}),a.header=new Fancy.grid.Header({widget:a,side:"center"}),a.rightHeader=new Fancy.grid.Header({widget:a,side:"right"})),a.leftBody=new Fancy.grid.Body({widget:a,side:"left"}),a.body=new Fancy.grid.Body({widget:a,side:"center"}),a.rightBody=new Fancy.grid.Body({widget:a,side:"right"}),a.leftEl=a.el.select(".fancy-grid-left"),a.centerEl=a.el.select(".fancy-grid-center"),a.rightEl=a.el.select(".fancy-grid-right")},getFieldsFromData:function(a){var b=a.items||a;if(a.fields)return a.fields;if(!b)throw new Error("not set fields of data");var c=b[0],d=[];for(var e in c)d.push(e);return d},render:function(){var a=this,b=a.renderTo||document.body,c=Fancy.get(document.createElement("div"));c.addClass(Fancy.cls),c.addClass(a.cls),c.attr("id",a.id),void 0===a.panel&&a.shadow&&c.addClass("fancy-panel-shadow"),a.columnLines===!1&&c.addClass("fancy-grid-disable-column-lines"),"default"===a.theme||a.panel||c.addClass("fancy-theme-"+a.theme),c.css({width:a.width+"px",height:a.height+"px"}),c.update(a.tpl.join(" ")),a.el=Fancy.get(Fancy.get(b).dom.appendChild(c.dom))},update:function(){var a=this,b=a.store;b.loading||a.updater.update()},setSides:function(){var a=this,b=a.leftColumns,c=a.columns,d=a.rightColumns,e=0,f=b.length,g=0,h=0,i=0,j=0;for(a.panel&&(j=a.panelBorderWidth),b.length>0&&a.leftEl.removeClass("fancy-grid-left-empty"),d.length>0&&a.rightEl.removeClass("fancy-grid-right-empty");f>e;e++)g+=b[e].width;for(e=0,f=c.length;f>e;e++)h+=c[e].width;for(e=0,f=d.length;f>e;e++)i+=d[e].width;0===g&&0===i?h=a.width-1-2*j:0===i?(g+=1,h=a.width-g-1-j):0===g?(j?i+=2*j:i++,h=a.width-i):a.width>g+h+i?(g+=1,h=a.width-g-i-1-2*j,i=a.width-g-h):h=a.width-g-i-j,a.leftEl.css({width:g+"px"}),a.centerEl.css({left:g+"px",width:h+"px"}),a.el.select(".fancy-grid-left .fancy-grid-header").css({width:g+"px"}),a.el.select(".fancy-grid-center .fancy-grid-header").css({width:h+"px"}),a.el.select(".fancy-grid-center .fancy-grid-body").css({width:h+"px"}),a.width>g+h+i?a.rightEl.css({right:"0px"}):a.rightEl.css({left:"",right:"0px"}),a.rightEl.css({width:i}),a.el.select(".fancy-grid-right .fancy-grid-header").css({width:i+"px"})},setColumnsPosition:function(){var a=this;a.body.setColumnsPosition(),a.leftBody.setColumnsPosition(),a.rightBody.setColumnsPosition()},setSidesHeight:function(){var a=this,b=a.store,c=1;a.header!==!1&&(c+=a.cellHeaderHeight,a.filter&&a.filter.header&&(c+=a.cellHeaderHeight)),a.grouping&&(c+=a.grouping.groups.length*a.groupRowHeight),c+=b.getLength()*a.cellHeight-1,a.leftEl.css({height:c+"px"}),a.centerEl.css({height:c+"px"}),a.rightEl.css({height:c+"px"})},preRender:function(){var a=this;(a.title||a.tbar||a.bbar||a.buttons)&&a.renderPanel()},renderPanel:function(){var a=this,b={renderTo:a.renderTo,title:a.title,width:a.width,height:a.height,titleHeight:a.titleHeight,barHeight:a.barHeight,theme:a.theme,shadow:a.shadow};a.bbar&&(b.bbar=a.bbar,a.height-=a.barHeight),a.tbar&&(b.tbar=a.tbar,a.height-=a.barHeight),a.buttons&&(b.buttons=a.buttons,a.height-=a.barHeight),a.footer&&(b.footer=a.footer,a.height-=a.barHeight),a.panel=new Fancy.Panel(b),a.bbar=a.panel.bbar,a.tbar=a.panel.tbar,a.buttons=a.panel.buttons,a.panel.el.addClass("fancy-panel-grid-inside"),a.title?a.height-=a.titleHeight:a.bbar||a.tbar,a.height-=a.panelBorderWidth,a.renderTo=a.panel.el.select(".fancy-panel-body-inner").dom},getBodyHeight:function(){var a=this,b=a.height,c=1;return a.groupheader&&(c=2),a.filter&&a.filter.header&&c++,a.header!==!1&&(b-=a.cellHeaderHeight*c),b},ons:function(){var a=this,b=a.store,c=Fancy.get(document);b.on("change",a.onChangeStore,a),b.on("set",a.onSetStore,a),b.on("sort",a.onSortStore,a),b.on("beforeload",a.onBeforeLoadStore,a),b.on("load",a.onLoadStore,a),c.on("mouseup",a.onDocMouseUp,a),c.on("click",a.onDocClick,a),c.on("mousemove",a.onDocMove,a)},onChangeStore:function(){var a=this;a.update()},onBeforeLoadStore:function(a){var b=this;b.fire("beforeload")},onLoadStore:function(a){var b=this;b.fire("load")},onSetStore:function(a,b){var c=this;c.fire("set",b)},onSortStore:function(a,b){var c=this;c.fire("sort",b)},getCellsViewHeight:function(){var a=this,b=a.store,c=0,d=0;return a.grouping&&(c=a.grouping.plusScroll),a.scroller.scrollBottomEl.hasClass("fancy-display-none")||(d=a.scroller.cornerSize),a.cellHeight*b.dataView.length+d+c+2*a.panelBorderWidth},onDocMouseUp:function(){var a=this;a.fire("docmouseup")},onDocClick:function(a){var b=this;b.fire("docclick",a)},onDocMove:function(a){var b=this;b.fire("docmove",a)},getCenterViewWidth:function(){var a=this;return a.centerEl.width()},getCenterFullWidth:function(){for(var a=this,b=0,c=a.columns,d=0,e=c.length;e>d;d++)b+=c[d].width;return b},getColumns:function(a){var b,c=this;switch(a){case"left":b=c.leftColumns;break;case"center":b=c.columns;break;case"right":b=c.rightColumns}return b},getBody:function(a){var b,c=this;switch(a){case"left":b=c.leftBody;break;case"center":b=c.body;break;case"right":b=c.rightBody}return b},detectModulesDir:function(){return FancyGrid.MODULESDIR?void 0:this.debug?void(FancyGrid.MODULESDIR="http://test.fancygrid.com/modules/"):void(FancyGrid.MODULESDIR="https://code.fancygrid.com/modules/")},loadModules:function(){var a=this,b=Fancy.modules||{},c={},d=a.columns||[],e=a.leftColumns||[],f=a.rightColumns||[];a.detectModulesDir(),Fancy.modules=b,Fancy.isTouch&&(c.touch=!0),a.paging&&(c.paging=!0),a.filter&&(c.filter=!0),Fancy.isObject(a.data)&&(a.data.proxy&&(c["server-data"]=!0),a.data.chart&&(c["chart-integration"]=!0)),a.isGroupedHeader&&(c["grouped-header"]=!0),a.grouping&&(c.grouping=!0),(a.trackOver||a.columnTrackOver||a.cellTrackOver||a.selection)&&(c.selection=!0);for(var g=d.concat(e).concat(f),h=0,i=g.length;i>h;h++){var j=g[h];switch(j.sortable===!0&&(c.sort=!0),j.editable===!0&&(c.edit=!0),j.filter&&(c.filter=!0),j.type){
case"progressbar":case"progressdonut":case"grossloss":c.spark=!0,c.tooltip=!0}j.cellTip&&(c.tooltip=!0)}c.spark&&(c.tooltip=!0),a.neededModules={length:0};for(var k in c)void 0===Fancy.modules[k]&&(a.neededModules[k]=!0,a.neededModules.length++);if(0===a.neededModules.length)return a.neededModules=!0,void a.init();for(var k in a.neededModules)"length"!==k&&a.loadModule(k)},loadModule:function(a){var b=this,c=document.getElementsByTagName("body")[0],d=document.createElement("script"),e=a,f=b.debug?".js":".min.js";a=a.replace(/ /g,"-"),d.src=FancyGrid.MODULESDIR+a+f,d.charset="utf-8",d.onload=function(){Fancy.modules[e]=!0,delete b.neededModules[a],b.neededModules.length--,0===b.neededModules.length&&(b.neededModules=!0,b.init())},c.appendChild(d)},getDomRow:function(a){for(var b=this,c=b.leftBody,d=b.body,e=b.rightBody,f=b.leftColumns,g=b.columns,h=b.rightColumns,i=0,j=f.length,k=[];j>i;i++)k.push(c.getDomCell(a,i));for(i=0,j=g.length;j>i;i++)k.push(d.getDomCell(a,i));for(i=0,j=h.length;j>i;i++)k.push(e.getDomCell(a,i));return k},selectColumn:function(){},initTextSelection:function(){var a=this,b=a.body,c=a.leftBody,d=a.rightBody;a.textSelection===!1&&(a.el.addClass("fancy-grid-unselectable"),b.el.on("mousedown",function(a){a.preventDefault()}),c.el.on("mousedown",function(a){a.preventDefault()}),d.el.on("mousedown",function(a){a.preventDefault()}))},setTrackOver:function(a,b){var c=this;switch(a){case"cell":c.cellTrackOver=b;break;case"column":c.columnTrackOver=b;break;case"row":c.trackOver=b}},setSelModel:function(a){var b=this,c=b.selection;c.cell=!1,c.cells=!1,c.row=!1,c.rows=!1,c.column=!1,c.columns=!1,c[a]=!0,c.clearSelection()},getSelection:function(){var a=this;return a.selection.getSelection()},destroy:function(){var a=this,b=Fancy.get(document);b.un("mouseup",a.onDocMouseUp,a),b.un("click",a.onDocClick,a),b.un("mousemove",a.onDocMove,a),a.body.destroy(),a.leftBody.destroy(),a.rightBody.destroy(),a.header.destroy(),a.leftHeader.destroy(),a.rightHeader.destroy(),a.scroller.destroy(),a.el.destroy(),a.panel&&a.panel.el.destroy()}});var FancyGrid=Fancy.Grid;FancyGrid.get=function(a){var b=Fancy.get(a).select(".fancy-grid").dom.id;return Fancy.getWidget(b)},FancyGrid.defineTheme=Fancy.defineTheme,Fancy.$.fn.FancyGrid=function(a){return a.renderTo=$(this.selector)[0].id,new Fancy.Grid(a)},Fancy.define("Fancy.grid.plugin.Updater",{extend:Fancy.Plugin,ptype:"grid.updater",inWidgetName:"updater",constructor:function(a){var b=this;Fancy.applyConfig(b,a),b.Super("const",arguments)},init:function(){},update:function(){var a=this,b=a.widget;b.leftBody.update(),b.body.update(),b.rightBody.update()},updateRow:function(a){var b=this,c=b.widget;c.leftBody.updateRows(a),c.body.updateRows(a),c.rightBody.updateRows(a)}}),Fancy.define("Fancy.grid.plugin.Scroller",{extend:Fancy.Plugin,ptype:"grid.scroller",inWidgetName:"scroller",rightScrollCls:"fancy-scroll-right",bottomScrollCls:"fancy-scroll-bottom",rightKnobDown:!1,bottomKnobDown:!1,minRightKnobHeight:35,minBottomKnobWidth:35,cornerSize:12,constructor:function(a){var b=this;b.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.ons()},ons:function(){var a=this,b=a.widget,c=Fancy.getMouseWheelEventName();b.once("render",function(){a.render(),b.leftBody.el.on(c,a.onMouseWheel,a),b.body.el.on(c,a.onMouseWheel,a),b.rightBody.el.on(c,a.onMouseWheel,a),b.once("init",a.onGridInit,a)}),a.on("render",a.onRender,a),b.store.on("change",a.onChangeStore,a)},destroy:function(){var a=this,b=a.widget,c=b.leftBody,d=b.body,e=b.rightBody,f=Fancy.get(document),g=Fancy.getMouseWheelEventName();f.un("mouseup",a.onMouseUpDoc,a),f.un("mousemove",a.onMouseMoveDoc,a),c.el.un(g,a.onMouseWheel,a),d.el.un(g,a.onMouseWheel,a),e.el.un(g,a.onMouseWheel,a),a.scrollBottomEl.un("mousedown",a.onMouseDownBottomSpin,a),a.scrollRightEl.un("mousedown",a.onMouseDownRightSpin,a),Fancy.isTouch&&(c.el.un("touchstart",a.onBodyTouchStart,a),c.el.un("touchmove",a.onBodyTouchMove,a),d.el.un("touchstart",a.onBodyTouchStart,a),d.el.un("touchmove",a.onBodyTouchMove,a),e.el.un("touchstart",a.onBodyTouchStart,a),e.el.un("touchmove",a.onBodyTouchMove,a),f.un("touchend",a.onMouseUpDoc,a))},onGridInit:function(){var a=this,b=a.widget,c=Fancy.get(document);a.setScrollBars(),c.on("mouseup",a.onMouseUpDoc,a),c.on("mousemove",a.onMouseMoveDoc,a),b.on("columnresize",a.onColumnResize,a)},render:function(){var a=this,b=a.widget,c=b.body,d=Fancy.get(document.createElement("div")),e=Fancy.get(document.createElement("div"));d.addClass(a.rightScrollCls);var f=1;b.panel&&(f=b.panelBorderWidth,0===b.leftColumns.length&&0===b.rightColumns.length&&(f=0)),b.rightColumns&&b.rightColumns.length>0&&(f=1),d.css("right",f+"px"),e.addClass(a.bottomScrollCls),d.update(['<div class="fancy-scroll-right-inner"></div>'].join(" ")),e.update(['<div class="fancy-scroll-bottom-inner"></div>'].join(" ")),Fancy.get(c.el.append(d.dom)),a.scrollRightEl=c.el.select(".fancy-scroll-right"),Fancy.get(c.el.append(e.dom)),a.scrollBottomEl=c.el.select(".fancy-scroll-bottom"),a.fire("render")},onMouseWheel:function(a){var b=this,c=(b.widget,b.getWheelDelta(a.originalEvent));a.preventDefault(),0!=b.isRightScrollable()&&(b.scrollDelta(c),b.scrollRightKnob())},getWheelDelta:function(a){var b=0;return a.wheelDelta?b=a.wheelDelta/120:a.detail&&(b=-a.detail/3),b},onRender:function(){var a=this;a.scrollRightEl.hover(function(){a.bottomKnobDown!==!0&&a.scrollRightEl.addClass("fancy-scroll-right-hover")},function(){a.scrollRightEl.removeClass("fancy-scroll-right-hover")}),a.scrollBottomEl.hover(function(){a.rightKnobDown!==!0&&a.scrollBottomEl.addClass("fancy-scroll-bottom-hover")},function(){a.scrollBottomEl.removeClass("fancy-scroll-bottom-hover")}),a.initRightScroll(),a.initBottomScroll(),Fancy.isTouch&&a.initTouch()},initTouch:function(){var a=this,b=a.widget,c=b.leftBody,d=b.body,e=b.rightBody,f=Fancy.get(document);c.el.on("touchstart",a.onBodyTouchStart,a),c.el.on("touchmove",a.onBodyTouchMove,a),d.el.on("touchstart",a.onBodyTouchStart,a),d.el.on("touchmove",a.onBodyTouchMove,a),e.el.on("touchstart",a.onBodyTouchStart,a),e.el.on("touchmove",a.onBodyTouchMove,a),f.on("touchend",a.onMouseUpDoc,a)},onBodyTouchStart:function(a){var b=this,a=a.originalEvent,c=a.changedTouches[0];b.rightKnobDown=!0,b.bottomKnobDown=!0,b.mouseDownXY={x:c.pageX,y:c.pageY},b.rightKnobTop=parseInt(b.rightKnob.css("margin-top")),b.scrollRightEl.addClass("fancy-scroll-right-active"),b.bottomKnobLeft=parseInt(b.bottomKnob.css("margin-left")),b.scrollBottomEl.addClass("fancy-scroll-bottom-active")},onBodyTouchEnd:function(){var a=this;a.onMouseUpDoc()},onBodyTouchMove:function(a){var b=this,a=a.originalEvent,c=a.changedTouches[0];b.rightKnobDown===!0&&a.preventDefault(),b.bottomKnobDown===!0&&a.preventDefault(),b.onMouseMoveDoc({pageX:c.pageX,pageY:c.pageY})},initRightScroll:function(){var a=this;a.widget,Fancy.get(document);a.rightKnob=a.scrollRightEl.select(".fancy-scroll-right-inner"),a.scrollRightEl.on("mousedown",a.onMouseDownRightSpin,a)},initBottomScroll:function(){var a=this;a.widget,Fancy.get(document);a.bottomKnob=a.scrollBottomEl.select(".fancy-scroll-bottom-inner"),a.scrollBottomEl.on("mousedown",a.onMouseDownBottomSpin,a)},onMouseDownRightSpin:function(a){var b=this;Fancy.isTouch||(a.preventDefault(),b.rightKnobDown=!0,b.mouseDownXY={x:a.pageX,y:a.pageY},b.rightKnobTop=parseInt(b.rightKnob.css("margin-top")),b.scrollRightEl.addClass("fancy-scroll-right-active"))},onMouseDownBottomSpin:function(a){var b=this;a.preventDefault(),b.bottomKnobDown=!0,b.mouseDownXY={x:a.pageX,y:a.pageY},b.bottomKnobLeft=parseInt(b.bottomKnob.css("margin-left")),b.scrollBottomEl.addClass("fancy-scroll-bottom-active")},onMouseUpDoc:function(){var a=this;(a.rightKnobDown!==!1||a.bottomKnobDown!==!1)&&(a.scrollRightEl.removeClass("fancy-scroll-right-active"),a.scrollBottomEl.removeClass("fancy-scroll-bottom-active"),a.rightKnobDown=!1,a.bottomKnobDown=!1)},onMouseMoveDoc:function(a){var b=this,c=!1,d=!1;if(b.rightKnobDown){var e,f,g,h=a.pageX,i=a.pageY;Fancy.isTouch?(e=b.mouseDownXY.x-h,f=b.mouseDownXY.y-i,g=f+b.rightKnobTop):(e=h-b.mouseDownXY.x,f=i-b.mouseDownXY.y,g=f+b.rightKnobTop),1>g&&(g=1),b.bodyViewHeight-2<g+b.rightKnobHeight&&(g=b.bodyViewHeight-b.rightKnobHeight-2),b.rightScrollScale<1&&(b.rightScrollScale=0,g=0),b.rightKnob.css("margin-top",g+"px"),c=b.rightScrollScale*(g-1),b.scroll(c)}if(b.bottomKnobDown){var e,f,j,h=a.pageX,i=a.pageY;Fancy.isTouch?(e=b.mouseDownXY.x-h,f=b.mouseDownXY.y-i,j=e+b.bottomKnobLeft):(e=h-b.mouseDownXY.x,f=i-b.mouseDownXY.y,j=e+b.bottomKnobLeft),1>j&&(j=1),b.bodyViewWidth-2<j+b.bottomKnobWidth&&(j=b.bodyViewWidth-b.bottomKnobWidth-2),b.bottomScrollScale<0&&0>j&&(j=0,b.bottomScrollScale=0),b.bottomKnob.css("margin-left",j+"px"),d=b.bottomScrollScale*(j-1),b.scroll(!1,d)}},setScrollBars:function(){var a=this;a.checkRightScroll(),a.checkBottomScroll(),a.checkCorner(),a.setRightKnobSize(),a.setBottomKnobSize()},checkRightScroll:function(){var a=this,b=a.widget,c=b.getBodyHeight(),d=b.getCellsViewHeight();c>d?a.scrollRightEl.addClass("fancy-display-none"):a.scrollRightEl.removeClass("fancy-display-none")},isRightScrollable:function(){var a=this;return!a.scrollRightEl.hasClass("fancy-display-none")},setRightKnobSize:function(){var a=this,b=a.widget,c=b.getBodyHeight()-(a.corner?a.cornerSize:0)-2,d=b.getCellsViewHeight()-(a.corner?a.cornerSize:0),e=d-c,f=100-e/(c/100),g=c*(f/100)-2;g<a.minRightKnobHeight&&(g=a.minRightKnobHeight),a.rightKnob.css("height",g+"px"),a.rightKnobHeight=g,a.bodyViewHeight=c,a.rightScrollScale=(d-c)/(c-g-2-1)},checkBottomScroll:function(){var a=this,b=a.widget,c=b.getCenterViewWidth(),d=b.getCenterFullWidth();c>d?a.scrollBottomEl.addClass("fancy-display-none"):a.scrollBottomEl.removeClass("fancy-display-none")},checkCorner:function(){var a=this;a.scrollRightEl.hasClass("fancy-display-none")||a.scrollBottomEl.hasClass("fancy-display-none")?a.corner=!1:a.corner=!0},setBottomKnobSize:function(){var a=this,b=a.widget,c=b.getCenterViewWidth()-(a.corner?a.cornerSize:0),d=b.getCenterFullWidth()-(a.corner?a.cornerSize:0),e=d-c,f=100-e/(d/100),g=c*(f/100)-2;g<a.minBottomKnobWidth&&(g=a.minBottomKnobWidth),a.bottomKnob.css("width",g+"px"),a.bottomKnobWidth=g,a.bodyViewWidth=c,a.bottomScrollScale=(c-d)/(c-g-2-1)},scroll:function(a,b){var c,d=this,e=d.widget;e.leftBody.scroll(a,b),c=e.body.scroll(a,b),e.rightBody.scroll(a,b),void 0!==c.scrollTop&&(d.scrollTop=Math.abs(c.scrollTop)),e.fire("scroll")},scrollDelta:function(a){var b,c=this,d=c.widget;d.leftBody.wheelScroll(a),b=d.body.wheelScroll(a),d.rightBody.wheelScroll(a),c.scrollTop=Math.abs(b.newScroll),d.fire("scroll")},scrollRightKnob:function(){var a=this,b=a.getScroll(),c=b/a.rightScrollScale+1;a.rightKnob.css("margin-top",c+"px")},getScroll:function(){var a=this,b=a.widget;return Math.abs(parseInt(b.body.el.select(".fancy-grid-column").item(0).css("top")))},update:function(){var a=this;a.setScrollBars(),a.checkScroll()},onChangeStore:function(){var a=this;a.setScrollBars(),a.checkScroll()},onColumnResize:function(){var a=this;a.setScrollBars()},checkScroll:function(){var a=this,b=a.widget,c=a.getScroll(),d=b.getBodyHeight()-(a.corner?a.cornerSize:0),e=b.getCellsViewHeight()-(a.corner?a.cornerSize:0);c&&d>e&&(a.scroll(0),a.scrollRightKnob())}}),Fancy.define("Fancy.grid.plugin.LoadMask",{extend:Fancy.Plugin,ptype:"grid.loadmask",inWidgetName:"loadmask",cls:"fancy-loadmask",constructor:function(a){var b=this;b.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.ons()},ons:function(){var a=this,b=a.widget;b.store;b.once("render",function(){a.render(),b.on("beforeload",a.onBeforeLoad,a),b.on("load",a.onLoad,a)})},render:function(){var a,b,c=this,d=c.widget,e=d.el,f=e,g=Fancy.get(document.createElement("div")),h=d.lang;d.panel&&(f=d.panel.el),a=f.width(),b=f.height(),g.addClass(c.cls),"default"!==d.theme&&g.addClass("fancy-theme-"+d.theme),g.css({width:a,height:b,opacity:0}),g.update(['<div class="fancy-loadmask-inner"><div class="fancy-loadmask-image"></div><div class="fancy-loadmask-text">'+h.loadingText+"</div></div>"].join(" ")),c.el=Fancy.get(f.dom.appendChild(g.dom)),c.innerEl=c.el.select(".fancy-loadmask-inner");var i=c.innerEl.width(),j=c.innerEl.height();c.innerEl.css({left:a/2-i/2,top:b/2-j/2}),d.store.loading!==!0?g.css("display","none"):(g.css("display","none"),c.showLoadMask()),g.css("opacity",1)},onBeforeLoad:function(){var a=this;a.showLoadMask()},onLoad:function(){var a=this;a.loaded=!0,a.el.css("display","none")},showLoadMask:function(){var a=this;a.loaded=!1,setTimeout(function(){a.loaded!==!0&&a.el.css("display","block")},50)}}),Fancy.define("Fancy.grid.plugin.ColumnResizer",{extend:Fancy.Plugin,ptype:"grid.columnresizer",inWidgetName:"columnresizer",constructor:function(a){var b=this;b.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),b.on("render",function(){a.render(),a.ons()})},ons:function(){var a=this,b=a.widget;b.on("headercellmousemove",a.onCellMouseMove,a),b.on("headercellmousedown",a.onHeaderCellMouseDown,a),b.on("docclick",a.onDocClick,a),b.on("docmove",a.onDocMove,a),b.on("docmouseup",a.onDocMouseUp,a)},onCellMouseMove:function(a,b){var c=this,d=c.widget,e=b.e,f=Fancy.get(b.cell),g=e.offsetX,h=f.width();d.startResizing||(7>g&&0!==b.index?c.isColumnResizable(b,!0)&&Fancy.get(e.target).closest(".fancy-field").hasClass("fancy-field")===!1&&c.addCellResizeCls(b.cell):7>h-g?c.isColumnResizable(b)&&c.addCellResizeCls(b.cell):c.removeCellResizeCls(b.cell))},addCellResizeCls:function(a){Fancy.get(a).addClass("fancy-grid-column-resizer")},removeCellResizeCls:function(a){Fancy.get(a).removeClass("fancy-grid-column-resizer")},onHeaderCellMouseDown:function(a,b){var c=this,d=c.widget,a=b.e,e=Fancy.get(b.cell),f=a.offsetX,g=e.width();7>f&&0!==b.index?(d.startResizing=!0,c.cell=c.getPrevCell(b),c.activeSide=b.side,c.clientX=a.clientX,c.columnIndex=b.index-1):7>g-f&&(d.startResizing=!0,c.cell=b.cell,c.activeSide=b.side,c.clientX=a.clientX,c.columnIndex=b.index),d.startResizing&&c.isColumnResizable()},isColumnResizable:function(a,b){var c,d,e,f=this,g=f.widget;if(a){if(c=g.getColumns(a.side),e=a.index,b&&e--,isNaN(e))return;return d=c[e],d.resizable===!0}c=g.getColumns(f.activeSide),c[f.columnIndex].resizable!==!0&&(g.startResizing=!1,delete f.cell,delete f.activeSide,delete f.clientX,delete f.columnIndex)},onDocClick:function(){var a=this,b=a.widget;b.startResizing=!1},onDocMove:function(a,b){var c=this,d=c.widget;d.startResizing&&c.moveResizeEls(b)},render:function(){var a=this,b=a.widget,c=Fancy.get(document.createElement("div")),d=Fancy.get(document.createElement("div"));c.addClass("fancy-grid-resizer-left"),d.addClass("fancy-grid-resizer-right"),a.leftEl=Fancy.get(b.el.dom.appendChild(c.dom)),a.rightEl=Fancy.get(b.el.dom.appendChild(d.dom))},moveResizeEls:function(a){var b=this,c=b.widget,d=Fancy.get(b.cell),e=parseInt(d.css("left"));switch(b.activeSide){case"left":break;case"center":e+=parseInt(c.leftEl.css("width"));break;case"right":e+=parseInt(c.leftEl.css("width")),e+=parseInt(c.centerEl.css("width"))}b.leftEl.css({display:"block",left:e+"px"});var f=a.clientX,g=f-b.clientX,h=d.width()+g;h<c.minCellWidth&&(h=c.minCellWidth),b.deltaWidth=d.width()-h,b.rightEl.css({display:"block",left:e+h+"px"}),b.cellWidth=h},onDocMouseUp:function(){var a=this,b=a.widget;b.startResizing!==!1&&(a.leftEl.css({display:"none"}),a.rightEl.css({display:"none"}),a.resizeColumn(),b.startResizing=!1,delete a.cellWidth)},resizeColumn:function(){var a,b,c=this,d=c.widget,e=c.cellWidth,f=c.columnIndex,g=c.deltaWidth,h=d.leftEl,i=d.centerEl,j=d.rightEl,k=d.leftHeader.el,l=d.header.el,m=d.rightHeader.el,n=d.body.el,o={};if(void 0!==e){switch(c.activeSide){case"left":var p=parseInt(i.css("width"))+g+1;if(p<d.minCenterWidth)return;d.leftColumns[c.columnIndex].width=e,a=d.leftBody.el.select(".fancy-grid-column"),b=d.leftHeader.el.select(".fancy-grid-header-cell"),a.item(f).css("width",e+"px");for(var q=c.columnIndex+1,r=d.leftColumns.length;r>q;q++){var s=a.item(q),t=b.item(q);s.css("left",parseInt(s.css("left"))-g-1),t.css("left",parseInt(t.css("left"))-g-1)}h.css("width",parseInt(h.css("width"))-g-1),k.css("width",parseInt(k.css("width"))-g-1+"px"),d.columns.length&&(i.css("left",parseInt(i.css("left"))-g-1),i.css("width",p),l.css("width",parseInt(l.css("width"))+g+1),n.css("width",parseInt(n.css("width"))+g+1)),d.rightColumns;break;case"center":d.columns[c.columnIndex].width=e,a=d.body.el.select(".fancy-grid-column"),b=d.header.el.select(".fancy-grid-header-cell"),a.item(f).css("width",e+"px");for(var q=c.columnIndex+1,r=d.columns.length;r>q;q++){var s=a.item(q),t=b.item(q),u=parseInt(s.css("left"))-g-1;t.attr("group-index")&&(o[t.attr("group-index")]={delta:g}),s.css("left",u),t.css("left",u)}d.rightColumns.length;break;case"right":var p=parseInt(i.css("width"))+g+1;if(p<d.minCenterWidth)return;d.rightColumns[c.columnIndex].width=e,a=d.rightBody.el.select(".fancy-grid-column"),b=d.rightHeader.el.select(".fancy-grid-header-cell"),a.item(f).css("width",e+"px");for(var q=c.columnIndex+1,r=d.rightColumns.length;r>q;q++){var s=a.item(q),t=b.item(q);s.css("left",parseInt(s.css("left"))-g-1),t.css("left",parseInt(t.css("left"))-g-1)}j.css("width",parseInt(j.css("width"))-g-1),m.css("width",parseInt(m.css("width"))-g-1+"px"),d.columns.length&&(i.css("width",p),l.css("width",parseInt(l.css("width"))+g+1),n.css("width",parseInt(n.css("width"))+g+1))}var v,w=Fancy.get(c.cell),x=w.attr("group-index");if(w.css("width",e+"px"),x)v=d.el.select("[index='"+x+"']"),v.css("width",parseInt(v.css("width"))-g-1);else for(var y in o)v=d.el.select("[index='"+y+"']"),v.css("left",parseInt(v.css("left"))-o[y].delta-1);d.fire("columnresize",{cell:w.dom,width:e})}},getPrevCell:function(a){var b,c=this,d=c.widget;switch(a.side){case"left":b=d.leftHeader;break;case"center":b=d.header;break;case"right":b=d.rightHeader}return b.el.select(".fancy-grid-header-cell").item(a.index-1).dom}}),Fancy.define("Fancy.grid.plugin.Licence",{extend:Fancy.Plugin,ptype:"grid.licence",inWidgetName:"licence",constructor:function(a){var b=this;b.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.ons()},ons:function(){var a=this,b=a.widget;b.once("render",function(){a.render()})},render:function(){var a=this,b=a.widget,c=b.body,d=Fancy.get(document.createElement("div"));/fancygrid/.test(location.host)||(d.css({position:"absolute",right:"4px",bottom:"0px","z-index":1,width:"30px",height:"30px"}),Fancy.get(c.el.append(d.dom)))}}),Fancy.ns("Fancy.grid.body.mixin"),Fancy.grid.body.mixin.Updater=function(){},Fancy.grid.body.mixin.Updater.prototype={update:function(){var a=this,b=a.widget,c=b.store;a.checkDomColumns(),c.loading||(a.checkDomCells(),a.updateRows())},checkDomColumns:function(){var a=this,b=(a.widget,a.el.select(".fancy-grid-column").length),c=a.getColumns(),d=0,e=c.length;if(!(b>=e)){for(;e>d;d++){var f=c[d],g=f.width,h=Fancy.get(document.createElement("div"));h.addClass("fancy-grid-column"),f.cls&&h.addClass(f.cls),"text"===f.type&&h.addClass("fancy-grid-column-text"),h.css({width:g+"px"}),h.attr("index",d),f.cellAlign&&h.css("text-align",f.cellAlign),a.el.dom.appendChild(h.dom)}a.fire("adddomcolumns")}},checkDomCells:function(){var a,b,c=this,d=c.widget,e=d.store,f=0,g=e.dataView.length,h=0;switch(c.side){case"left":b=d.leftColumns;break;case"center":b=d.columns,bodyCls="fancy-grid-body";break;case"right":b=d.rightColumns}a=b.length;var i=c.el.select(".fancy-grid-column"),j=e.getLength(),k=c.cellTpl;for(d.cellWrapper&&(k=c.cellWrapperTpl);a>h;h++){column=b[h];var l=i.item(h);f=0;var m=j-l.select(".fancy-grid-cell").length;for(f=g-m;g>f;f++){var n=k.getHTML({}),o=Fancy.get(document.createElement("div"));o.css({height:d.cellHeight+"px"}),o.addClass(c.cellCls),o.attr("index",f),f%2!==0&&d.striped&&o.addClass(d.cellEvenCls),o.update(n),l.dom.appendChild(o.dom)}}},updateRows:function(a){var b,c,d=this,e=d.widget,f=(e.store,0);switch(d.side){case"left":b=e.leftColumns;break;case"center":b=e.columns;break;case"right":b=e.rightColumns}for(c=b.length;c>f;f++){var g=b[f];switch(g.type){case"string":case"number":case"combo":case"action":case"text":d.renderUniversal(f,a);break;case"color":d.renderColor(f,a);break;case"checkbox":d.renderCheckbox(f,a);break;case"image":d.renderImage(f,a);break;case"sparklineline":d.renderSparkLine(f,a,"line");break;case"sparklinebar":d.renderSparkLine(f,a,"bar");break;case"sparklinetristate":d.renderSparkLine(f,a,"tristate");break;case"sparklinediscrete":d.renderSparkLine(f,a,"discrete");break;case"sparklinebullet":d.renderSparkLine(f,a,"bullet");break;case"sparklinepie":d.renderSparkLine(f,a,"pie");break;case"sparklinebox":d.renderSparkLine(f,a,"box");break;case"circle":d.renderCircle(f,a);break;case"progressdonut":d.renderProgressDonut(f,a);break;case"progressbar":d.renderProgressBar(f,a);break;case"grossloss":d.renderGrossLoss(f,a);break;default:throw new Error("[FancyGrid error] - not existed column type "+g.type)}}d.removeNotUsedCells()},renderUniversal:function(a,b){var c,d,e=this,f=e.widget,g=f.store,h=e.getColumns(),i=h[a],j=i.key||i.index||("action"===i.type?"none":void 0),k=e.el.select(".fancy-grid-column"),l=k.item(a),m=l.select("."+f.cellCls),n=l.select("."+f.cellCls+" ."+f.cellInnerCls);for(void 0!==b?(c=b,d=b+1):(c=0,d=g.getLength());d>c;c++){var o,p=g.get(c),q={rowIndex:c,data:p,style:{},column:i};o=i.smartIndexFn?i.smartIndexFn(p):g.get(c,j),q.value=o,i.format&&Fancy.isString(i.format)&&(q.value=e.getFormat(i.format)(q.value),o=q.value),i.render&&(q=i.render(q),o=q.value),""===o&&(o="&nbsp;"),m.item(c).css(q.style),n.item(c).update(o)}},renderColor:function(a,b){var c,d,e=this,f=e.widget,g=f.store,h=e.getColumns(),i=h[a],j=i.key||i.index,k=e.el.select(".fancy-grid-column"),l=k.item(a),m=l.select("."+f.cellCls),n=l.select("."+f.cellCls+" ."+f.cellInnerCls);for(void 0!==b?(c=b,d=b+1):(c=0,d=g.getLength());d>c;c++){var o,p=g.get(c),q={rowIndex:c,data:p,style:{},column:i};o=i.smartIndexFn?i.smartIndexFn(p):g.get(c,j),q.value=o,m.item(c).css(q.style);n.item(c).update('<div style="background-color:'+o+';" class="fancy-grid-color-cell"></div>')}},renderCombo:function(a,b){var c,d,e=this,f=e.widget,g=f.store,h=e.getColumns(),i=h[a],j=i.key||i.index,k=e.el.select(".fancy-grid-column"),l=k.item(a),m=l.select("."+f.cellCls),n=l.select("."+f.cellCls+" ."+f.cellInnerCls);for(void 0!==b?(c=b,d=b+1):(c=0,d=g.getLength());d>c;c++){var o=g.get(c,j),p={rowIndex:c,value:o,style:{}};i.render&&(p=i.render(p),o=p.value),m.item(c).css(p.style),n.item(c).update(o)}},renderCheckbox:function(a,b){var c,d,e=this,f=e.widget,g=f.store,h=e.getColumns(),i=h[a],j=i.key||i.index,k=e.el.select(".fancy-grid-column"),l=k.item(a),m=(l.select("."+f.cellCls),l.select("."+f.cellCls+" ."+f.cellInnerCls));for(void 0!==b?(c=b,d=b+1):(c=0,d=g.getLength());d>c;c++){var n,o=g.get(c,j),p=m.item(c),q=p.select(".fancy-field-checkbox"),r=0!==q.length;r===!1?new Fancy.CheckBox({renderTo:m.item(c).dom,renderId:!0,value:o,label:!1,style:{padding:"0px"},events:[{beforechange:function(a){i.editable!==!0&&(a.canceledChange=!0)}},{change:function(a,b){f.celledit.checkBoxChangedValue=b}}]}):(n=q.dom.id,q=Fancy.getWidget(n),q.set(o,!1))}},renderImage:function(a,b){var c,d,e=this,f=e.widget,g=f.store,h=e.getColumns(),i=h[a],j=i.key||i.index||("action"===i.type?"none":void 0),k=e.el.select(".fancy-grid-column"),l=k.item(a),m=l.select("."+f.cellCls),n=l.select("."+f.cellCls+" ."+f.cellInnerCls);for(void 0!==b?(c=b,d=b+1):(c=0,d=g.getLength());d>c;c++){var o=g.get(c,j),p=g.get(c),q={rowIndex:c,value:o,data:p,style:{}};o='<img src="'+q.value+'">',m.item(c).css(q.style),n.item(c).update(o)}},renderSparkLine:function(a,b,c){var d,e,f=this,g=f.widget,h=g.cellHeight,i=g.store,j=f.getColumns(),k=j[a],l=k.width,m=k.key||k.index||("action"===k.type?"none":void 0),n=f.el.select(".fancy-grid-column"),o=n.item(a),p=o.select("."+g.cellCls),q=o.select("."+g.cellCls+" ."+g.cellInnerCls),r=k.sparkConfig||{};o.addClass(g.clsSparkColumn),void 0!==b?(d=b,e=b+1):(d=0,e=i.getLength());var s,t=h-1,u=l-20;switch(c){case"line":case"pie":case"box":s="width";break;case"bullet":s="width",t-=11,o.addClass(g.clsSparkColumnBullet);break;case"discrete":s="width",u=l,t-=2;break;case"bar":case"tristate":s="barWidth"}for(;e>d;d++){var v=i.get(d,m),w=i.get(d),x={rowIndex:d,value:v,data:w,style:{}};if(k.render&&(x=k.render(x),v=x.value),Fancy.isArray(k.values)){var y=0,z=k.values.length;for(v=[];z>y;y++)v.push(i.get(d,k.values[y]))}p.item(d).css(x.style);var A=q.item(d).dom,B={type:c,fillColor:"transparent",height:t};Fancy.apply(B,r),("bar"===c||"tristate"===c)&&(u=l-20,u/=v.length),B[s]=u,Fancy.$(A).sparkline(v,B)}},renderProgressDonut:function(a,b){var c,d,e=this,f=e.widget,g=f.store,h=e.getColumns(),i=h[a],j=i.key||i.index,k=e.el.select(".fancy-grid-column"),l=k.item(a),m=l.select("."+f.cellCls),n=l.select("."+f.cellCls+" ."+f.cellInnerCls);for(l.addClass(f.clsSparkColumnDonutProgress),void 0!==b?(c=b,d=b+1):(c=0,d=g.getLength());d>c;c++){var o,p=g.get(c),q={rowIndex:c,data:p,style:{},column:i};o=i.smartIndexFn?i.smartIndexFn(p):g.get(c,j),q.value=o,i.format&&Fancy.isString(i.format)&&(q.value=e.getFormat(i.format)(q.value),o=q.value),i.render&&(q=i.render(q),o=q.value),m.item(c).css(q.style);var r=i.sparkConfig||{},s=n.item(c).dom;Fancy.apply(r,{renderTo:s,value:o}),r.size||r.height||r.width||(r.size=f.cellHeaderHeight-6),Fancy.get(s).update(""),new Fancy.spark.ProgressDonut(r)}},renderGrossLoss:function(a,b){var c,d,e=this,f=e.widget,g=f.store,h=e.getColumns(),i=h[a],j=i.key||i.index,k=e.el.select(".fancy-grid-column"),l=k.item(a),m=l.select("."+f.cellCls),n=l.select("."+f.cellCls+" ."+f.cellInnerCls);l.addClass(f.clsColumnGrossLoss),void 0!==b?(c=b,d=b+1):(c=0,d=g.getLength());var o=i.sparkConfig||{};for(o.showOnMax&&(o.maxValue=Math.max.apply(Math,g.getColumnData(j,i.smartIndexFn)));d>c;c++){var p,q=g.get(c),r={rowIndex:c,data:q,style:{},column:i};p=i.smartIndexFn?i.smartIndexFn(q):g.get(c,j),r.value=p,i.format&&Fancy.isString(i.format)&&(r.value=e.getFormat(i.format)(r.value),p=r.value),i.render&&(r=i.render(r),p=r.value),m.item(c).css(r.style),Fancy.apply(o,{renderTo:n.item(c).dom,value:p,column:i}),new Fancy.spark.GrossLoss(o)}},renderProgressBar:function(a,b){var c,d,e=this,f=e.widget,g=f.store,h=e.getColumns(),i=h[a],j=i.key||i.index,k=e.el.select(".fancy-grid-column"),l=k.item(a),m=l.select("."+f.cellCls),n=l.select("."+f.cellCls+" ."+f.cellInnerCls),o=100;l.addClass(f.clsColumnGrossLoss),void 0!==b?(c=b,d=b+1):(c=0,d=g.getLength());var p=i.sparkConfig||{};for(p.percents===!1&&(o=Math.max.apply(Math,g.getColumnData(j)));d>c;c++){var q,r=g.get(c),s={rowIndex:c,data:r,style:{},column:i};q=i.smartIndexFn?i.smartIndexFn(r):g.get(c,j),s.value=q,i.format&&Fancy.isString(i.format)&&(s.value=e.getFormat(i.format)(s.value),q=s.value),i.render&&(s=i.render(s),q=s.value),m.item(c).css(s.style),Fancy.apply(p,{renderTo:n.item(c).dom,value:q,column:i,maxValue:o}),new Fancy.spark.ProgressBar(p)}},renderCircle:function(a,b){function c(a,b){var c="http://www.w3.org/2000/svg",d=document.createElementNS(c,"svg:svg");d.setAttribute("width",b),d.setAttribute("height",b),d.setAttribute("viewBox","0 0 "+b+" "+b);var e=document.createElementNS(c,"circle");e.setAttributeNS(null,"cx",b/2),e.setAttributeNS(null,"cy",b/2),e.setAttributeNS(null,"r",b/2);var f="#F0F0F0";b>50&&(f="F0F0F0"),0>a&&(f="#F9DDE0"),e.setAttributeNS(null,"fill",f),d.appendChild(e);var g=document.createElementNS(c,"path"),h=2*Math.PI/100,i=0,j=a*h-.001,k=b/2+b/2*Math.sin(i),l=b/2-b/2*Math.cos(i),m=b/2+b/2*Math.sin(j),n=b/2-b/2*Math.cos(j),o=0;j-i>Math.PI&&(o=1);var p="M "+b/2+","+b/2+" L "+k+","+l+" A "+b/2+","+b/2+" 0 "+o+" 1 "+m+","+n+" Z";g.setAttribute("d",p),0>a?g.setAttribute("fill","#EA7369"):g.setAttribute("fill","#44A4D3"),d.appendChild(g);var q=document.createElementNS(c,"circle");return q.setAttributeNS(null,"cx",b/2),q.setAttributeNS(null,"cy",b/2),q.setAttributeNS(null,"r",.25*b),q.setAttributeNS(null,"fill","#fff"),d.appendChild(q),d}var d,e,f=this,g=f.widget,h=g.store,i=f.getColumns(),j=i[a],k=j.key||j.index||("action"===j.type?"none":void 0),l=f.el.select(".fancy-grid-column"),m=l.item(a),n=(m.select("."+g.cellCls),m.select("."+g.cellCls+" ."+g.cellInnerCls)),o=g.cellHeight-4;j.width;for(m.addClass(g.clsSparkColumnCircle),void 0!==b?(d=b,e=b+1):(d=0,e=h.getLength());e>d;d++){var p,q=h.get(d),r={rowIndex:d,data:q,style:{}};p=j.smartIndexFn?j.smartIndexFn(q):h.get(d,k),r.value=p,j.render&&(r=j.render(r),p=r.value);var s=n.item(d).dom;""===s.innerHTML&&s.appendChild(c(p,o))}},removeNotUsedCells:function(){for(var a=this,b=a.widget,c=b.store,d=a.el.select(".fancy-grid-column"),e=0,f=d.length;f>e;e++)for(var g=d.item(e),h=g.select(".fancy-grid-cell"),i=c.getLength(),j=h.length;j>i;i++)h.item(i).remove()},getFormat:function(a){var b=this,c=b.widget,d=c.lang;switch(a){case"number":return function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,d.thousandSeparator)}}}},Fancy.define("Fancy.grid.Body",{extend:Fancy.Widget,mixins:[Fancy.grid.body.mixin.Updater],cls:"fancy-grid-body",cellCls:"fancy-grid-cell",cellTpl:['<div class="fancy-grid-cell-inner">{cellValue}</div>'],cellWrapperTpl:['<div class="fancy-grid-cell-wrapper">','<div class="fancy-grid-cell-inner">{cellValue}</div>',"</div>"],constructor:function(a){var b=this;b.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.addEvents("adddomcolumns"),a.initTpl(),a.render(),a.ons()},initTpl:function(){var a=this;a.cellTpl=new Fancy.Template(a.cellTpl),a.cellWrapperTpl=new Fancy.Template(a.cellWrapperTpl)},ons:function(){var a=this,b=a.widget;b.on("afterrender",a.onAfterRender,a),a.el.on("click",a.onCellClick,a,"div.fancy-grid-cell"),a.el.on("dblclick",a.onCellDblClick,a,"div.fancy-grid-cell"),a.el.on("mouseenter",a.onCellMouseEnter,a,"div.fancy-grid-cell"),a.el.on("mouseleave",a.onCellMouseLeave,a,"div.fancy-grid-cell"),a.el.on("mousedown",a.onCellMouseDown,a,"div.fancy-grid-cell"),a.el.on("mouseenter",a.onColumnMouseEnter,a,"div.fancy-grid-column"),a.el.on("mouseleave",a.onColumnMouseLeave,a,"div.fancy-grid-column")},render:function(){var a,b=this,c=b.widget,d=Fancy.get(document.createElement("div"));d.addClass(b.cls),a=c.el.select(".fancy-grid-"+b.side).dom,b.el=Fancy.get(a.appendChild(d.dom))},onAfterRender:function(){var a=this,b=a.widget;b.store;a.update(),a.setHeight()},setColumnsPosition:function(a){var b=this,c=b.getColumns(),d=0,e=c.length,f=0,g=b.el.select(".fancy-grid-column"),a=a||b.scrollLeft||0;for(f+=a;e>d;d++){var h=c[d],i=g.item(d);i.css({left:f+"px"}),f+=h.width}},wheelScroll:function(a){var b=this,c=b.widget,d=b.el.select(".fancy-grid-column");if(0!==d.length){for(var e=0,f=d.length,g=c.getBodyHeight(),h=(b.el.height(),c.getCellsViewHeight()),i=h-g,j={oldScroll:parseInt(d.item(0).css("top")),newScroll:parseInt(d.item(0).css("top"))+30*a,deltaScroll:30*a};f>e;e++){var k=d.item(e),l=parseInt(k.css("top"))+30*a;l>0?(l=0,j.newScroll=0):Math.abs(l)>i&&(l=-i,j.newScroll=l),k.css("top",l+"px")}return j}},scroll:function(a,b){var c=this,d=c.widget,e=c.el.select(".fancy-grid-column"),f=0,g=e.length,h={};if(a!==!1)for(h.scrollTop=a;g>f;f++){var i=e.item(f);i.css("top",-a+"px")}return void 0!==b&&(h.scrollLeft=b,d.header.scroll(b),c.scrollLeft=b,d.body.setColumnsPosition(b)),h},setHeight:function(){var a=this,b=a.widget,c=b.getBodyHeight();a.el.css("height",c+"px")},onCellClick:function(a){var b=this,c=b.widget;c.fire("cellclick",b.getEventParams(a)),c.fire("rowclick",b.getEventParams(a)),c.fire("columnclick",b.getColumnEventParams(a));
},onCellDblClick:function(a){var b=this,c=b.widget;c.fire("celldblclick",b.getEventParams(a)),c.fire("rowdblclick",b.getEventParams(a)),c.fire("columndblclick",b.getColumnEventParams(a))},getEventParams:function(a){var b=this,c=b.widget,d=c.store,e=b.getColumns(),f=a.currentTarget,g=Fancy.get(a.currentTarget),h=g.parent(),i=parseInt(h.attr("index")),j=parseInt(g.attr("index")),k=e[i],l=k.index||k.key,m=d.get(j,l),n=d.get(j);return k.smartIndexFn&&(m=k.smartIndexFn(n)),{e:a,side:b.side,cell:f,column:k,rowIndex:j,columnIndex:i,value:m,data:n}},getColumnEventParams:function(a){var b=this,c=b.widget,d=c.store,e=(a.currentTarget,Fancy.get(a.currentTarget)),f=e.parent(),g=parseInt(f.attr("index")),h=b.getColumns(),i=h[g],j={e:a,side:b.side,columnIndex:g,column:i,columnDom:f.dom};return c.columnClickData&&(j.data=d.getColumnData(i.index,i.smartIndexFn)),j},getColumnHoverEventParams:function(a){var b=this,c=b.widget,d=(c.store,Fancy.get(a.currentTarget)),e=parseInt(d.attr("index")),f=b.getColumns(),g=f[e];return{e:a,side:b.side,columnIndex:e,column:g,columnDom:d.dom}},getColumns:function(){var a=this,b=a.widget;return b.getColumns(a.side)},onCellMouseEnter:function(a){var b=this,c=b.widget,d=b.getEventParams(a),e=b.prevCellOver;e?d.rowIndex!==b.prevCellOver.rowIndex&&c.fire("rowenter",d):c.fire("rowenter",d),c.fire("cellenter",d),b.prevCellOver=d},onCellMouseDown:function(a){var b=this,c=b.widget,d=b.getEventParams(a),e={e:d.e,side:d.side,columnDom:Fancy.get(d.cell).parent().dom,column:d.column,columnIndex:d.columnIndex};c.fire("cellmousedown",d),c.fire("columnmousedown",e)},onCellMouseLeave:function(){var a=this,b=a.widget;b.fire("rowleave",a.prevCellOver),b.fire("cellleave",a.prevCellOver),delete a.prevCellOver},onColumnMouseEnter:function(a){var b=this,c=b.widget,d=b.getColumnHoverEventParams(a),e=b.prevColumnOver;e?d.rowIndex!==b.prevCellOver.rowIndex&&c.fire("rowenter",d):c.fire("columnenter",d),b.prevColumnOver=d},onColumnMouseLeave:function(){var a=this,b=a.widget;b.fire("columnleave",a.prevColumnOver),delete a.prevColumnOver},getCell:function(a,b){var c=this;return c.el.select('.fancy-grid-column[index="'+b+'"] .fancy-grid-cell[index="'+a+'"]')},getDomCell:function(a,b){var c=this;return c.el.select('.fancy-grid-column[index="'+b+'"] .fancy-grid-cell[index="'+a+'"]').dom},getDomColumn:function(a){var b=this;return b.el.select('.fancy-grid-column[index="'+a+'"]').dom},destroy:function(){var a=this;a.el.un("click",a.onCellClick,a,"div.fancy-grid-cell"),a.el.un("dblclick",a.onCellDblClick,a,"div.fancy-grid-cell"),a.el.un("mouseenter",a.onCellMouseEnter,a,"div.fancy-grid-cell"),a.el.un("mouseleave",a.onCellMouseLeave,a,"div.fancy-grid-cell"),a.el.un("mousedown",a.onCellMouseDown,a,"div.fancy-grid-cell"),a.el.un("mouseenter",a.onColumnMouseEnter,a,"div.fancy-grid-column"),a.el.un("mouseleave",a.onColumnMouseLeave,a,"div.fancy-grid-column")}}),Fancy.define("Fancy.grid.Header",{extend:Fancy.Widget,cls:"fancy-grid-header",cellTpl:['<div class="fancy-grid-header-cell {cls}" style="width:{columnWidth}px;height: {height};left: {left};" {groupIndex} index="{index}">','<div class="fancy-grid-header-cell-container">','<span class="fancy-grid-header-cell-text">{columnName}</span>','<span class="fancy-grid-header-cell-trigger"></span>',"</div>","</div>"],constructor:function(a){var b=this;b.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.initTpl(),a.render(),a.setAlign(),a.setCellsPosition(),a.ons()},initTpl:function(){var a=this;a.cellTpl=new Fancy.Template(a.cellTpl)},ons:function(){var a=this,b=a.widget;b.on("render",a.onAfterRender,a),a.el.on("click",a.onCellClick,a,"div.fancy-grid-header-cell"),a.el.on("mousemove",a.onCellMouseMove,a,"div.fancy-grid-header-cell"),a.el.on("mousedown",a.onCellMouseDown,a,"div.fancy-grid-header-cell"),a.el.on("mousedown",a.onMouseDown,a)},render:function(){var a,b=this,c=b.widget,d=b.getColumns(),e=Fancy.get(document.createElement("div")),f="",g=0,h=d.length,i=1,j={},k=0;for(c.groupheader&&(i=2),c.filter&&c.filter.header&&i++;h>g;g++){var l=d[g],m=(l.key||l.index,l.title||l.header),n="initial",o="",p="";1!==i&&(l.grouping?(j[l.grouping]||(j[l.grouping]={width:0,text:l.grouping,left:k}),j[l.grouping].width+=l.width,p='group-index="'+l.grouping+'"',o="fancy-grid-header-cell-group-level-1"):n=i*c.cellHeaderHeight+"px"),k+=l.width;var q=b.cellTpl.getHTML({cls:o,columnName:m,columnWidth:l.width,index:g,height:n,left:"initial",groupIndex:p});f+=q}e.css({height:c.cellHeaderHeight*i+"px",width:b.getColumnsWidth()}),e.addClass(b.cls),c.groupheader&&(e.addClass("fancy-grid-header-grouped"),f+=b.getGroupingCellsHTML(j)),e.update(f),a=c.el.select(".fancy-grid-"+b.side).dom,b.el=Fancy.get(a.appendChild(e.dom))},setAlign:function(){for(var a=this,b=(a.widget,a.getColumns()),c=0,d=b.length;d>c;c++){var e=b[c];e.align&&a.getDomCell(c).css("text-align",e.align)}},onAfterRender:function(){},setCellsPosition:function(){var a=this,b=a.widget,c=a.getColumns(),d=0,e=0,f=c.length,g=a.el.select(".fancy-grid-header-cell"),h=1;for(d+=a.scrollLeft||0,e=0;f>e;e++){var i=c[e],j=g.item(e),k="0px";i.grouping&&(k=b.cellHeaderHeight+"px"),j.css({top:k,left:d+"px"}),d+=i.width}if(b.groupheader){h=2;var l=a.el.select(".fancy-grid-header-cell-group-level-2"),m=0,n=l.length;if(void 0!==a.scrollLeft)for(;n>m;m++){var o=l.item(m),p=o.attr("index"),q=a.el.select('[group-index="'+p+'"]').item(0).css("left");o.css("left",q)}}},getColumnsWidth:function(){for(var a=this,b=(a.widget,a.getColumns()),c=0,d=0,e=b.length;e>d;d++){var f=b[d];c+=f.width}return c},getColumns:function(){var a,b=this,c=b.widget;switch(b.side){case"left":a=c.leftColumns;break;case"center":a=c.columns;break;case"right":a=c.rightColumns}return a},getDomCell:function(a){var b=this;return b.el.select(".fancy-grid-header-cell").item(a)},onCellClick:function(a){var b=this,c=b.widget,d=a.currentTarget,e=parseInt(Fancy.get(d).attr("index"));c.fire("headercellclick",{e:a,side:b.side,cell:d,index:e})},onCellMouseMove:function(a){var b=this,c=b.widget,d=a.currentTarget,e=parseInt(Fancy.get(d).attr("index"));c.fire("headercellmousemove",{e:a,side:b.side,cell:d,index:e})},onMouseDown:function(a){var b=Fancy.get(a.target);"INPUT"===b.prop("tagName")||a.preventDefault()},onCellMouseDown:function(a){var b=this,c=b.widget,d=a.currentTarget,e=parseInt(Fancy.get(d).attr("index"));c.fire("headercellmousedown",{e:a,side:b.side,cell:d,index:e})},scroll:function(a){var b=this;b.scrollLeft=a,b.setCellsPosition()},getGroupingCellsHTML:function(a){var b=this,c=b.widget,d="";for(var e in a){var f=a[e];d+=b.cellTpl.getHTML({cls:"fancy-grid-header-cell-group-level-2",columnName:f.text,columnWidth:f.width,index:e,height:c.cellHeaderHeight+"px",left:f.left+"px",groupIndex:""})}return d},destroy:function(){var a=this;a.el.un("click",a.onCellClick,a,"div.fancy-grid-header-cell"),a.el.un("mousemove",a.onCellMouseMove,a,"div.fancy-grid-header-cell"),a.el.un("mousedown",a.onCellMouseDown,a,"div.fancy-grid-header-cell"),a.el.un("mousedown",a.onMouseDown,a)},getCell:function(a){var b=this;return b.el.select(".fancy-grid-header-cell[index="+a+"]")}});